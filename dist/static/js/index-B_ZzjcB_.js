import{_ as e}from"./index-t37Q_uZ0.js";import{d as a,u as l,k as t,J as r,e as d,o as s,f as n,h as o,w as i,m as u,g as c,F as p,j as m,c as f,E as y,r as x,b as _,G as b,t as v,i as h,V as w,_ as I}from"./index-kCgCNWEL.js";import{a as g}from"./regexp-LyZ7ySAN.js";import{u as k}from"./useDict-CIZTrc45.js";const C={class:"gi-edit-table"},$=a({name:"GiEditTable",inheritAttrs:!1,__name:"GiEditTable",props:{columns:{},data:{},cellDisabled:{default:!1}},setup(e,{expose:a}){const _=e,b=l(),v=t((()=>({tableData:_.data}))),h=r("formRef"),w=e=>e.required?"gi_column_require":"",I=e=>{const a={};return"input"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`,a.maxLength=50),"input-number"===e.type&&(a.placeholder=`请输入${e.title}`),"textarea"===e.type&&(a.allowClear=!0,a.placeholder=`填写${e.title}`,a.maxLength=200),"select"===e.type&&(a.allowClear=!0,a.placeholder=`请选择${e.title}`),"cascader"===e.type&&(a.allowClear=!0,a.placeholder=`请选择${e.title}`),"tree-select"===e.type&&(a.allowClear=!0,a.placeholder=`请选择${e.title}`),"date-picker"===e.type&&(a.placeholder="请选择日期"),"time-picker"===e.type&&(a.allowClear=!0,a.placeholder="请选择时间"),{...a,...e.props}},g=e=>["input","input-number"].includes(e.type??"")?`请输入${e.title}`:["textarea"].includes(e.type??"")?`请填写${e.title}`:["select","cascader","tree-select"].includes(e.type??"")?`请选择${e.title}`:["date-picker"].includes(e.type??"")?"请选择日期":["time-picker"].includes(e.type??"")?"请选择时间":"";return a({formRef:h}),(e,a)=>{const l=d("a-form-item"),t=d("a-table-column"),r=d("a-table"),k=d("a-form");return s(),n("div",C,[o(k,{ref_key:"formRef",ref:h,model:c(v)},{default:i((()=>[o(r,u({data:c(v).tableData,bordered:{cell:!0},pagination:!1},c(b)),{columns:i((()=>[(s(!0),n(p,null,m(_.columns,(a=>(s(),f(t,u({key:a.dataIndex,title:a.title,"data-index":a.dataIndex,"header-cell-class":w(a),ref_for:!0},a.columnProps),{cell:i((({record:t,rowIndex:r,column:d})=>[o(l,u({field:`tableData[${r}].${a.dataIndex}`,"label-col-style":{display:"none"},"wrapper-col-props":{span:24},ref_for:!0},a.formItemProps,{rules:[{required:a.required||!1,message:g(a)},...a.rules||[]]}),{default:i((()=>{return[a.slotName?y(e.$slots,a.dataIndex,u({key:0,ref_for:!0},{record:t,rowIndex:r,column:d})):(s(),f(x(`a-${a.type}`),u({key:1,ref_for:!0},I(a),{modelValue:t[a.dataIndex],"onUpdate:modelValue":e=>t[a.dataIndex]=e,disabled:(l={row:t,rowIndex:r,col:a},"boolean"==typeof(null==_?void 0:_.cellDisabled)?_.cellDisabled:"function"==typeof(null==_?void 0:_.cellDisabled)&&_.cellDisabled(l))}),null,16,["modelValue","onUpdate:modelValue","disabled"]))];var l})),_:2},1040,["field","rules"])])),_:2},1040,["title","data-index","header-cell-class"])))),128))])),_:3},16,["data"])])),_:3},8,["model"])])}}}),j={class:"gi_page"},D=I(a({name:"FormTable",__name:"index",setup(a){const{data:l}=k({code:"status"}),u=_(!1),p=_([{name:"张三",phone:"",address:"广州市",rate:3,status:0,num:0}]),m=t((()=>JSON.stringify(p.value,null,"\t"))),f=r("GiEditTableRef"),y=t((()=>[{type:"input",title:"姓名",dataIndex:"name",required:!0},{type:"input",title:"手机号",dataIndex:"phone",required:!0,rules:[{match:g,message:"手机号格式不正确"}]},{type:"select",title:"状态",dataIndex:"status",props:{options:l.value}},{type:"rate",title:"评分",dataIndex:"rate",columnProps:{width:200}},{type:"input-number",title:"小数",dataIndex:"num",columnProps:{width:120}},{type:"textarea",title:"地址",dataIndex:"address",props:{autoSize:!0,maxLength:200,showWordLimit:!0},columnProps:{width:250}},{type:"",title:"操作",dataIndex:"action",slotName:"action",columnProps:{width:100,align:"center",fixed:"right"},formItemProps:{contentClass:"arco-table-cell-align-center"}}])),x=()=>{p.value.push({name:"",phone:"",address:"",rate:0,status:0,num:0})},I=()=>{var e,a;u.value=!u.value,u.value&&(null==(a=null==(e=f.value)?void 0:e.formRef)||a.clearValidate())},C=()=>{var e,a,l,t;null==(a=null==(e=f.value)?void 0:e.formRef)||a.resetFields(),null==(t=null==(l=f.value)?void 0:l.formRef)||t.clearValidate()},D=async()=>{var e,a;const l=await(null==(a=null==(e=f.value)?void 0:e.formRef)?void 0:a.validate());if(l){const e=Object.values(l);w.warning(e[0].message)}else w.success("验证通过~")},R=({rowIndex:e,col:a})=>!!u.value||"name"===a.dataIndex&&0===e;return(a,l)=>{const t=d("a-button"),r=d("icon-plus"),_=d("a-space"),w=d("a-row"),g=$,k=e,P=d("a-card");return s(),n("div",j,[o(P,{title:"编辑表格"},{default:i((()=>[o(w,{justify:"end"},{default:i((()=>[o(_,{wrap:""},{default:i((()=>[o(t,{type:"primary",status:c(u)?"success":"warning",onClick:I},{default:i((()=>[b(v(c(u)?"编辑":"只读"),1)])),_:1},8,["status"]),o(t,{type:"primary",onClick:x},{icon:i((()=>[o(r)])),default:i((()=>[l[0]||(l[0]=h("span",null,"新增",-1))])),_:1})])),_:1})])),_:1}),o(g,{ref_key:"GiEditTableRef",ref:f,scroll:{minWidth:1200},columns:c(y),data:c(p),"cell-disabled":R},{action:i((({rowIndex:e})=>[o(_,null,{default:i((()=>[o(t,{type:"primary",status:"danger",size:"mini",disabled:0===e,onClick:a=>{return l=e,void p.value.splice(l,1);var l}},{default:i((()=>l[1]||(l[1]=[b(" 删除 ")]))),_:2},1032,["disabled","onClick"])])),_:2},1024)])),_:1},8,["columns","data"]),o(w,{justify:"end",class:"gi_mt"},{default:i((()=>[o(_,{wrap:""},{default:i((()=>[o(t,{onClick:C},{default:i((()=>l[2]||(l[2]=[b("重置")]))),_:1}),o(t,{type:"primary",onClick:D},{default:i((()=>l[3]||(l[3]=[b("验证并提交")]))),_:1})])),_:1})])),_:1}),o(k,{"code-json":c(m)},null,8,["code-json"])])),_:1})])}}}),[["__scopeId","data-v-6721ba87"]]);export{D as default};
