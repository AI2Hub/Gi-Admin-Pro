import{_ as e}from"./index-Dp_ILRvO.js";import{d as a,u as l,k as t,J as r,e as d,o,f as s,h as n,w as i,m as u,g as c,F as p,j as m,c as f,E as x,r as _,b,G as y,V as h,t as v,i as w,_ as g}from"./index-CrLPKOLl.js";import I from"./FilterAddress-BsSunpt9.js";import{a as C}from"./regexp-LyZ7ySAN.js";import{u as $}from"./useDict-BbK-M0CT.js";const k={class:"gi-edit-table"},j=a({name:"GiEditTable",inheritAttrs:!1,__name:"GiEditTable",props:{columns:{},data:{},cellDisabled:{default:!1}},setup(e,{expose:a}){const b=e,y=l(),h=t((()=>({tableData:b.data}))),v=r("formRef"),w=e=>e.required?"gi_column_require":"",g=e=>({...new Map([["input",{allowClear:!0,placeholder:`请输入${e.title}`,maxLength:50}],["input-number",{placeholder:`请输入${e.title}`}],["textarea",{allowClear:!1,placeholder:`请填写${e.title}`,maxLength:200}],["input-tag",{allowClear:!0,placeholder:`请输入${e.title}`}],["mention",{allowClear:!0,placeholder:`请输入${e.title}`}],["select",{allowClear:!0,placeholder:`请选择${e.title}`}],["tree-select",{allowClear:!0,placeholder:`请选择${e.title}`}],["cascader",{allowClear:!0,placeholder:`请选择${e.title}`}],["radio-group",{}],["checkbox-group",{}],["date-picker",{allowClear:!0,placeholder:"请选择日期"}],["time-picker",{allowClear:!0,placeholder:"请选择时间"}]]).get(e.type)||{},...e.props}),I=e=>["input","input-number","input-tag","mention"].includes(e.type??"")?`请输入${e.title}`:["textarea"].includes(e.type??"")?`请填写${e.title}`:`请选择${e.title}`;return a({formRef:v}),(e,a)=>{const l=d("a-form-item"),t=d("a-table-column"),r=d("a-table"),C=d("a-form");return o(),s("div",k,[n(C,{ref_key:"formRef",ref:v,model:c(h)},{default:i((()=>[n(r,u({data:c(h).tableData,bordered:{cell:!0},pagination:!1},c(y)),{columns:i((()=>[(o(!0),s(p,null,m(b.columns,(a=>(o(),f(t,u({key:a.dataIndex,title:a.title,"data-index":a.dataIndex,"header-cell-class":w(a),ref_for:!0},a.columnProps),{cell:i((({record:t,rowIndex:r,column:d})=>[n(l,u({field:`tableData[${r}].${a.dataIndex}`,"label-col-style":{display:"none"},"wrapper-col-props":{span:24},ref_for:!0},a.formItemProps,{rules:[{required:a.required||!1,message:I(a)},...a.rules||[]]}),{default:i((()=>{return[a.slotName?x(e.$slots,a.dataIndex,u({key:0,ref_for:!0},{record:t,rowIndex:r,column:d})):(o(),f(_(`a-${a.type}`),u({key:1,ref_for:!0},g(a),{modelValue:t[a.dataIndex],"onUpdate:modelValue":e=>t[a.dataIndex]=e,disabled:(l={row:t,rowIndex:r,col:a},"boolean"==typeof(null==b?void 0:b.cellDisabled)?b.cellDisabled:"function"==typeof(null==b?void 0:b.cellDisabled)&&b.cellDisabled(l))}),null,16,["modelValue","onUpdate:modelValue","disabled"]))];var l})),_:2},1040,["field","rules"])])),_:2},1040,["title","data-index","header-cell-class"])))),128))])),_:3},16,["data"])])),_:3},8,["model"])])}}}),D={class:"gi_page"},R=g(a({name:"FormTable",__name:"index",setup(a){const{data:l}=$({code:"status"}),u=b(!1),p=b([{name:"张三",phone:"",address:"广州市",rate:3,status:0,num:0}]),m=t((()=>JSON.stringify(p.value,null,"\t"))),f=r("GiEditTableRef"),x=t((()=>[{type:"input",title:"姓名",dataIndex:"name",required:!0},{type:"input",title:"手机号",dataIndex:"phone",required:!0,rules:[{match:C,message:"手机号格式不正确"}]},{type:"select",title:"状态",dataIndex:"status",props:{options:l.value}},{type:"rate",title:"评分",dataIndex:"rate",columnProps:{width:200}},{type:"input-number",title:"小数",dataIndex:"num",columnProps:{width:120}},{type:"textarea",title:"地址",dataIndex:"address",props:{autoSize:!0,maxLength:200,showWordLimit:!0},columnProps:{width:250,title:()=>n(d("a-space"),null,{default:()=>[n("span",null,[y("地址")]),n(I,{onConfirm:e=>{h.success(`点击了确认，查询值为: ${e||"空"}`)}},null)]})}},{type:"",title:"操作",dataIndex:"action",slotName:"action",columnProps:{width:100,align:"center",fixed:"right"},formItemProps:{contentClass:"arco-table-cell-align-center"}}])),_=()=>{p.value.push({name:"",phone:"",address:"",rate:0,status:0,num:0})},g=()=>{var e,a;u.value=!u.value,u.value&&(null==(a=null==(e=f.value)?void 0:e.formRef)||a.clearValidate())},k=()=>{var e,a,l,t;null==(a=null==(e=f.value)?void 0:e.formRef)||a.resetFields(),null==(t=null==(l=f.value)?void 0:l.formRef)||t.clearValidate()},R=async()=>{var e,a;const l=await(null==(a=null==(e=f.value)?void 0:e.formRef)?void 0:a.validate());if(l){const e=Object.values(l);h.warning(e[0].message)}else h.success("验证通过~")},P=({rowIndex:e,col:a})=>!!u.value||"name"===a.dataIndex&&0===e;return(a,l)=>{const t=d("a-button"),r=d("icon-plus"),b=d("a-space"),h=d("a-row"),I=j,C=e,$=d("a-card");return o(),s("div",D,[n($,{title:"编辑表格"},{default:i((()=>[n(h,{justify:"end"},{default:i((()=>[n(b,{wrap:""},{default:i((()=>[n(t,{type:"primary",status:c(u)?"success":"warning",onClick:g},{default:i((()=>[y(v(c(u)?"编辑":"只读"),1)])),_:1},8,["status"]),n(t,{type:"primary",onClick:_},{icon:i((()=>[n(r)])),default:i((()=>[l[0]||(l[0]=w("span",null,"新增",-1))])),_:1})])),_:1})])),_:1}),n(I,{ref_key:"GiEditTableRef",ref:f,scroll:{minWidth:1200},columns:c(x),data:c(p),"cell-disabled":P},{action:i((({rowIndex:e})=>[n(b,null,{default:i((()=>[n(t,{type:"primary",status:"danger",size:"mini",disabled:0===e,onClick:a=>{return l=e,void p.value.splice(l,1);var l}},{default:i((()=>l[1]||(l[1]=[y(" 删除 ")]))),_:2},1032,["disabled","onClick"])])),_:2},1024)])),_:1},8,["columns","data"]),n(h,{justify:"end",class:"gi_mt"},{default:i((()=>[n(b,{wrap:""},{default:i((()=>[n(t,{onClick:k},{default:i((()=>l[2]||(l[2]=[y("重置")]))),_:1}),n(t,{type:"primary",onClick:R},{default:i((()=>l[3]||(l[3]=[y("验证并提交")]))),_:1})])),_:1})])),_:1}),n(C,{"code-json":c(m)},null,8,["code-json"])])),_:1})])}}}),[["__scopeId","data-v-6f00af80"]]);export{R as default};
