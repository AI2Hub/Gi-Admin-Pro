import{U as e,P as a,Y as t,b as n,M as s,V as l,k as o}from"./index-CJb6VCzA.js";import{d as i}from"./index-DyPUfkac.js";function r(o,i){const{formatResult:r,onSuccess:u,immediate:d,rowKey:g}=i||{},{pagination:p,setTotal:v}=function(n,s={defaultPageSize:10}){const{breakpoint:l}=c(),o=e({showPageSize:!0,showTotal:!0,current:1,pageSize:s.defaultPageSize,total:0,simple:!1,onChange:e=>{o.current=e,n&&n()},onPageSizeChange:e=>{o.current=1,o.pageSize=e,n&&n()}});a((()=>l.value),(()=>{o.simple=["xs"].includes(l.value),o.showTotal=!["xs"].includes(l.value)}),{immediate:!0});const i=o.onChange,r=o.onPageSizeChange,{current:u,pageSize:d,total:g}=t(o);return{current:u,pageSize:d,total:g,pagination:o,changeCurrent:i,changePageSize:r,setTotal:function(e){o.total=e}}}((()=>f())),h=n(!1),m=n([]);async function f(){try{h.value=!0;const e=await o({page:p.current,size:p.pageSize}),a=Array.isArray(e.data)?e.data:e.data.records;m.value=r?r(a):a;const t=Array.isArray(e.data)?a.length:e.data.total;v(t),u&&u()}finally{h.value=!1}}(d??!0)&&f();const y=n([]);return{loading:h,tableData:m,getTableData:f,search:()=>{y.value=[],p.onChange(1)},pagination:p,selectedKeys:y,select:e=>{y.value=e},selectAll:e=>{const a=g??"id",t=m.value.filter((e=>!(null==e?void 0:e.disabled)));y.value=e?t.map((e=>e[a])):[]},handleDelete:async(e,a)=>{const t=async()=>{try{const t=await e();return t.success&&(l.success((null==a?void 0:a.successTip)||"删除成功！"),y.value=[],f()),t.success}catch(t){return!1}};if(!((null==a?void 0:a.showModal)??!0))return t();s.warning({title:(null==a?void 0:a.title)||"提示",content:(null==a?void 0:a.content)||"是否确认删除？",hideCancel:!1,maskClosable:!1,onBeforeOk:t})}}}function c(){const e=i({xs:576,sm:576,md:768,lg:992,xl:1200,xxl:1600}).current();return{breakpoint:o((()=>e.value[e.value.length-1]||"xs"))}}export{c as a,r as u};
