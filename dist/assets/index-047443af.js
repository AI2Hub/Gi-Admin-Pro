import{L as e,M as n,eG as t,eH as l,eu as o,d as a,eE as i,G as s,eB as u,eI as d,g as c,z as m,eJ as r,r as p,o as f,c as h,a as v,w as y,f as _,F as g,b as C,u as b,e as w,J as j,t as k,E as I,W as M,X as x,N as F,R as T,i as L,p as E,j as N,h as B,_ as R}from"./index-2a0522db.js";import{f as D,i as J}from"./file-map-2a15779f.js";import{a as S}from"./index.es-5f2544f0.js";/* empty css               */import q from"./FileNavPath-a79facdc.js";import G from"./FileGrid-529fedc2.js";import z from"./FileList-853d991e.js";import{_ as H}from"./Dialog.vue_vue_type_script_setup_true_lang-fd2186b7.js";import K from"./Dialog-9a7852e9.js";import P from"./Dialog-c59fbd88.js";import V from"./Dialog-481c3539.js";import"./FileImg-90edbf85.js";import"./FileRightMenu-551d80d2.js";let $=null,Q=null;function W(e){null!==$&&$.unmount(),null!==Q&&document.body.removeChild(Q),Q=document.createElement("div"),document.body.appendChild(Q),$=t(H,{fileInfo:e,onCancel:()=>{setTimeout((()=>{!function(){null!==$&&$.unmount();null!==Q&&document.body.removeChild(Q)}(),$=null,Q=null}),500)}}).use(l).use(o),$.mount(Q)}let X=null,A=null;function O(e){null!==X&&X.unmount(),null!==A&&document.body.removeChild(A),A=document.createElement("div"),document.body.appendChild(A),X=t(K,{fileInfo:e,onCancel:()=>{setTimeout((()=>{!function(){null!==X&&X.unmount();null!==A&&document.body.removeChild(A)}(),X=null,A=null}),500)}}).use(l).use(o),X.mount(A)}const U=e=>(E("data-v-1756481f"),e=e(),N(),e),Y={class:"file-main"},Z=U((()=>B("span",null,"上传文件",-1))),ee=U((()=>B("span",null,"上传文件夹",-1))),ne=R(a({__name:"index",setup(a){var E;const N=i(),B=s(),{width:R}=u(),H=d(),K=c(!1),$=c([]),Q=c("0");Q.value=(null==(E=N.query.fileType)?void 0:E.toString())||"0";const X=async()=>{try{K.value=!0,A.value=!1;const l=await(t={fileType:Q.value},e.get(`${n}/file/list`,t));$.value=l.data.list}catch(l){return l}finally{K.value=!1}var t};m((()=>{X()})),r((e=>{var n;e.query.fileType&&(Q.value=null==(n=e.query.fileType)?void 0:n.toString(),X())}));const A=c(!1),U=e=>{if(F.success(`点击了文件-${e.name}`),J.includes(e.extendName)&&e.src){const n=$.value.filter((e=>J.includes(e.extendName))).map((e=>e.src||"")),t=n.findIndex((n=>n===e.src));n.length&&S({options:{initialViewIndex:t},images:n})}"mp4"===e.extendName&&W(e),"mp3"===e.extendName&&O(e)},ne=e=>{H.addSelectedFileItem(e)},te=(e,n)=>{F.success("点击了"+e),"delete"===e&&T.warning({title:"提示",content:"是否删除该文件？",hideCancel:!1}),"rename"===e&&function(e){const n=document.createElement("div");document.body.appendChild(n);const a=t(P,{fileInfo:e,onClose:()=>{setTimeout((()=>{a.unmount(),document.body.removeChild(n)}),350)}});a.use(l),a.use(o),a.mount(n)}(n),"move"===e&&function(e){const n=document.createElement("div");document.body.appendChild(n);const a=t(V,{fileInfo:e,onClose:()=>{setTimeout((()=>{a.unmount(),document.body.removeChild(n)}),350)}});a.use(l),a.use(o),a.mount(n)}(n),"detail"===e&&B.push({path:"/file/detail"})},le=()=>{T.warning({title:"提示",content:"是否确认删除？",hideCancel:!1})};return(e,n)=>{const t=p("icon-upload"),l=p("a-button"),o=L,a=p("a-doption"),i=p("a-dropdown"),s=p("a-option"),u=p("a-select"),d=p("a-input"),c=p("icon-search"),m=p("a-input-group"),r=p("a-space"),F=p("icon-delete"),T=p("icon-select-all"),E=p("icon-swap"),N=p("a-tooltip"),B=p("icon-filter"),J=p("icon-apps"),S=p("icon-list"),P=p("a-button-group"),V=p("a-row"),Q=p("a-empty"),W=p("a-spin");return f(),h("div",Y,[v(q),v(V,{justify:"space-between",class:"row-operate"},{default:y((()=>[v(r,null,{default:y((()=>[v(i,null,{content:y((()=>[v(a,null,{icon:y((()=>[v(o,{name:"upload-file"})])),default:y((()=>[Z])),_:1}),v(a,null,{icon:y((()=>[v(o,{name:"upload-folder"})])),default:y((()=>[ee])),_:1})])),default:y((()=>[v(l,{type:"primary",shape:"round"},{icon:y((()=>[v(t)])),default:y((()=>[_("上传")])),_:1})])),_:1}),v(m,null,{default:y((()=>[v(u,{style:{width:"150px"},placeholder:"请选择"},{default:y((()=>[(f(!0),h(g,null,C(b(D),(e=>(f(),w(s,{key:e.value},{icon:y((()=>[(f(),w(j(e.icon),{size:"18",color:"#999"}))])),default:y((()=>[_(k(e.name),1)])),_:2},1024)))),128))])),_:1}),v(d,{placeholder:"请输入关键词...","allow-clear":""}),v(l,{type:"primary"},{icon:y((()=>[v(c)])),default:y((()=>[_("搜索")])),_:1})])),_:1})])),_:1}),b(R)>715?(f(),w(r,{key:0},{default:y((()=>[b(A)?(f(),w(l,{key:0,disabled:!b(H).selectedFileIdList.length,type:"primary",status:"danger",onClick:le},{icon:y((()=>[v(F)])),_:1},8,["disabled"])):I("",!0),v(l,{type:"primary",onClick:n[0]||(n[0]=e=>A.value=!b(A))},{icon:y((()=>[v(T)])),default:y((()=>[_(k(b(A)?"取消批量":"批量操作"),1)])),_:1}),v(P,null,{default:y((()=>[v(N,{content:"传输列表",position:"bottom"},{default:y((()=>[v(l,{onClick:n[1]||(n[1]=e=>K.value=!b(K))},{icon:y((()=>[v(E)])),_:1})])),_:1}),v(N,{content:"排序",position:"bottom"},{default:y((()=>[v(l,null,{icon:y((()=>[v(B)])),_:1})])),_:1}),v(N,{content:"视图",position:"bottom"},{default:y((()=>[v(l,{onClick:b(H).changeViewMode},{icon:y((()=>["grid"===b(H).viewMode?(f(),w(J,{key:0})):(f(),w(S,{key:1}))])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})):I("",!0)])),_:1}),v(W,{class:"file-wrap",loading:b(K)},{default:y((()=>[M(v(G,{data:b($),isBatchMode:b(A),selectedFileIdList:b(H).selectedFileIdList,onClick:U,onCheck:ne,onRightMenuClick:te},null,8,["data","isBatchMode","selectedFileIdList"]),[[x,b($).length&&"grid"==b(H).viewMode]]),M(v(z,{data:b($),isBatchMode:b(A),onClick:U,onRightMenuClick:te},null,8,["data","isBatchMode"]),[[x,b($).length&&"list"==b(H).viewMode]]),M(v(Q,null,null,512),[[x,!b($).length]])])),_:1},8,["loading"])])}}}),[["__scopeId","data-v-1756481f"]]);export{ne as default};
