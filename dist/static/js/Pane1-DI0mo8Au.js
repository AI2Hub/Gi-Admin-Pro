import{_ as e}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-BaBQz0oW.js";import{u as t}from"./index-CRmKSH-V.js";import n from"./index-qQlVinU9.js";import{d as a,n as l,U as o,ag as i,e as s,o as r,f as c,h as d,w as p,g as u,i as m,G as g,t as h,K as f,V as b,ah as w,a3 as y,_ as x}from"./index-8uM-RDAq.js";import{u as _}from"./useBreakpoint-4K4f-nfZ.js";import{b as v}from"./index-pnJke7au.js";import{d as k}from"./index-D1H_nTjv.js";import{u as C}from"./useDict-zCSZvzca.js";import{_ as D}from"./index-5Z331Wyq.js";import"./RightMenu-DEpZramt.js";import"./index-CmIc8z95.js";const T={class:"page"},j={class:"pane-right__content"},A={class:"gi_table_box"},V=x(a({__name:"Pane1",setup(a){const{width:x}=t(),V=l(),{data:M}=C({code:"status"}),z=o({name:"",status:""}),{loading:P,tableData:I,getTableData:S,pagination:G,selectedKeys:K,select:B,selectAll:E,handleDelete:W}=_((e=>v({...z,...e})),{immediate:!1,formatResult:e=>e.map((e=>({...e,isEdit:!1})))});i((()=>{S()}));const J=()=>{V.push({path:"/data/form"})},R=()=>{V.push({path:"/data/form",query:{id:"ID123456"}})},$=()=>{if(!K.value.length)return b.warning("请选择删除项！");W((()=>k({ids:K.value})),{successTip:"批量删除成功！"})},q=()=>{if(!K.value.length)return b.warning("请勾选数据");b.success("点击了导出")},O=()=>{w.open({title:"数据结构",content:()=>y(D,{codeJson:'\n<template>\n  <div class="page">\n    <a-row align="stretch" :gutter="14" class="pane">\n      <a-col :xs="0" :sm="8" :md="7" :lg="6" :xl="5" :xxl="4" flex="260px" class="h-full ov-hidden">\n        <a-card title="数据分类" :bordered="false" class="gi_card pane-item pane-left">\n          <CateTree placeholder="请输入搜索关键词" @node-click="pagination.onChange(1)"></CateTree>\n        </a-card>\n      </a-col>\n\n      <a-col :xs="24" :sm="16" :md="17" :lg="18" :xl="19" :xxl="20" flex="1" class="h-full ov-hidden">\n        <a-card title="数据列表" :bordered="false" :header-style="{ display: \'none\' }" class="gi_card pane-item pane-right">\n          <div class="pane-right__content">\n            <a-row justify="space-between">\n              <a-space wrap>\n                <a-button type="primary" @click="onAdd">\n                  <template #icon><icon-plus /></template>\n                </a-button>\n                <a-button type="primary" status="danger" @click="onMulDelete">\n                  <template #icon><icon-delete /></template>\n                  <template #default>删除</template>\n                </a-button>\n                <a-button type="primary" status="success" @click="onExport">\n                  <template #icon><icon-export /></template>\n                </a-button>\n                <a-button type="primary" status="warning" @click="onViewCode">\n                  <template #icon><icon-code /></template>\n                  <span>查看代码</span>\n                </a-button>\n              </a-space>\n\n              <a-space wrap>\n                <a-select v-model="form.status" class="gi_select_input" :options="options" placeholder="请选择"\n                  allow-clear></a-select>\n                <a-input-group>\n                  <a-input v-model="form.name" placeholder="请输入搜索关键词" allow-clear> </a-input>\n                  <a-button type="primary" @click="getTableData">\n                    <icon-search />\n                  </a-button>\n                </a-input-group>\n                <a-button type="primary" @click="getTableData">\n                  <template #icon><icon-refresh /></template>\n                </a-button>\n              </a-space>\n            </a-row>\n\n            <section class="gi_table_box">\n              <a-table row-key="id" :loading="loading" :bordered="{ cell: true }" :data="tableData"\n                :scroll="{ x: \'100%\', y: \'100%\', minWidth: 1000 }"\n                :row-selection="{ type: \'checkbox\', showCheckedAll: true }" :pagination="pagination"\n                :selected-keys="selectedKeys" @select="select" @select-all="selectAll">\n                <template #columns>\n                  <a-table-column title="序号" :width="68">\n                    <template #cell="cell">{{ cell.rowIndex + 1 }}</template>\n                  </a-table-column>\n                  <a-table-column title="姓名" data-index="name"></a-table-column>\n                  <a-table-column title="地址" data-index="address" ellipsis tooltip></a-table-column>\n                  <a-table-column title="比例" :width="200">\n                    <template #cell="{ record }">\n                      <a-progress :status="getProportionColor(record.proportion)" :percent="record.proportion / 100" />\n                    </template>\n                  </a-table-column>\n                  <a-table-column title="状态" :width="100" align="center">\n                    <template #cell="{ record }">\n                      <GiCellStatus :status="record.status"></GiCellStatus>\n                    </template>\n                  </a-table-column>\n                  <a-table-column title="创建时间" data-index="createTime" :width="180"></a-table-column>\n                  <a-table-column title="操作" :width="200" align="center" :fixed="!isMobile() ? \'right\' : undefined">\n                    <template #cell="{ record }">\n                      <a-space>\n                        <a-button type="primary" size="mini" @click="onEdit">修改</a-button>\n                        <a-button size="mini" @click="onDetail(record)">详情</a-button>\n                        <a-popconfirm type="warning" content="您确定要删除该项吗?" @before-ok="onDelete(record)">\n                          <a-button type="primary" status="danger" size="mini">删除</a-button>\n                        </a-popconfirm>\n                      </a-space>\n                    </template>\n                  </a-table-column>\n                </template>\n              </a-table>\n            </section>\n          </div>\n        </a-card>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { Drawer, Message } from \'@arco-design/web-vue\'\nimport { useWindowSize } from \'@vueuse/core\'\nimport CateTree from \'./CateTree/index.vue\'\nimport Pane1Json from \'./code/pane1-json\'\nimport { useTable } from \'@/hooks\'\nimport { type PersonItem, getPersonList } from \'@/apis/person\'\nimport { deleteBaseApi } from \'@/apis/base\'\nimport { isMobile } from \'@/utils\'\nimport { useDict } from \'@/hooks/app\'\nimport GiCodeView from \'@/components/GiCodeView/index.vue\'\n\nconst { width } = useWindowSize()\nconst router = useRouter()\n\nconst { data: options } = useDict({ code: \'status\' })\nconst form = reactive({\n  name: \'\',\n  status: \'\'\n})\n\n// 这里使用了表格hooks：useTable, 节省了大量代码\nconst { loading, tableData, getTableData, pagination, selectedKeys, select, selectAll, handleDelete } = useTable(\n  (page) => getPersonList({ ...form, ...page }),\n  { immediate: false, formatResult: (data) => data.map((i) => ({ ...i, isEdit: false })) }\n)\n\n// 比例进度条颜色\nconst getProportionColor = (proportion: number) => {\n  if (proportion < 30) return \'danger\'\n  if (proportion < 60) return \'warning\'\n  return \'success\'\n}\n\nonActivated(() => {\n  getTableData()\n})\n\nconst onAdd = () => {\n  router.push({ path: \'/data/form\' })\n}\n\nconst onEdit = () => {\n  router.push({ path: \'/data/form\', query: { id: \'ID123456\' } })\n}\n\nconst onDetail = (item: PersonItem) => {\n  router.push({ path: \'/data/detail\', query: { id: item.id } })\n}\n\n// 删除\nconst onDelete = (item: PersonItem) => {\n  return handleDelete(() => deleteBaseApi({ ids: [item.id] }), { content: `是否删除 - ${ item.name }?`, showModal: false })\n}\n\n// 批量删除\nconst onMulDelete = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请选择删除项！\')\n  }\n  handleDelete(() => deleteBaseApi({ ids: selectedKeys.value as string[] }), { successTip: \'批量删除成功！\' })\n}\n\nconst onExport = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请勾选数据\')\n  }\n  Message.success(\'点击了导出\')\n}\n\nconst onViewCode = () => {\n  Drawer.open({\n    title: \'数据结构\',\n    content: () => h(GiCodeView, { codeJson: Pane1Json, type: \'vue\' }),\n    width: width.value < 500 ? \'100%\' : 560\n  })\n}\n<\/script>\n\n<style lang="scss" scoped>\n.page {\n  flex: 1;\n  padding: $margin;\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n\n  .pane {\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .pane-item {\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .pane-left {}\n\n  .pane-right {\n    &__content {\n      flex: 1;\n      overflow: hidden;\n      display: flex;\n      flex-direction: column;\n      box-sizing: border-box;\n    }\n  }\n}\n</style>\n',type:"vue"}),width:x.value<500?"100%":800})};return(t,a)=>{const l=s("a-card"),o=s("a-col"),i=s("icon-plus"),b=s("a-button"),w=s("icon-delete"),y=s("icon-export"),x=s("icon-code"),_=s("a-space"),v=s("a-select"),C=s("a-input"),D=s("icon-search"),U=s("a-input-group"),L=s("icon-refresh"),N=s("a-row"),X=s("a-table-column"),Y=s("a-progress"),Z=e,F=s("a-popconfirm"),H=s("a-table");return r(),c("div",T,[d(N,{align:"stretch",gutter:14,class:"pane"},{default:p((()=>[d(o,{xs:0,sm:8,md:7,lg:6,xl:5,xxl:4,flex:"260px",class:"h-full ov-hidden"},{default:p((()=>[d(l,{title:"数据分类",bordered:!1,class:"gi_card pane-item pane-left"},{default:p((()=>[d(n,{placeholder:"请输入搜索关键词",onNodeClick:a[0]||(a[0]=e=>u(G).onChange(1))})])),_:1})])),_:1}),d(o,{xs:24,sm:16,md:17,lg:18,xl:19,xxl:20,flex:"1",class:"h-full ov-hidden"},{default:p((()=>[d(l,{title:"数据列表",bordered:!1,"header-style":{display:"none"},class:"gi_card pane-item pane-right"},{default:p((()=>[m("div",j,[d(N,{justify:"space-between"},{default:p((()=>[d(_,{wrap:""},{default:p((()=>[d(b,{type:"primary",onClick:J},{icon:p((()=>[d(i)])),_:1}),d(b,{type:"primary",status:"danger",onClick:$},{icon:p((()=>[d(w)])),default:p((()=>a[3]||(a[3]=[g("删除")]))),_:1}),d(b,{type:"primary",status:"success",onClick:q},{icon:p((()=>[d(y)])),_:1}),d(b,{type:"primary",status:"warning",onClick:O},{icon:p((()=>[d(x)])),_:1})])),_:1}),d(_,{wrap:""},{default:p((()=>[d(v,{modelValue:u(z).status,"onUpdate:modelValue":a[1]||(a[1]=e=>u(z).status=e),class:"gi_select_input",options:u(M),placeholder:"请选择","allow-clear":""},null,8,["modelValue","options"]),d(U,null,{default:p((()=>[d(C,{modelValue:u(z).name,"onUpdate:modelValue":a[2]||(a[2]=e=>u(z).name=e),placeholder:"请输入搜索关键词","allow-clear":""},null,8,["modelValue"]),d(b,{type:"primary",onClick:u(S)},{default:p((()=>[d(D)])),_:1},8,["onClick"])])),_:1}),d(b,{type:"primary",onClick:u(S)},{icon:p((()=>[d(L)])),_:1},8,["onClick"])])),_:1})])),_:1}),m("section",A,[d(H,{"row-key":"id",loading:u(P),bordered:{cell:!0},data:u(I),scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:u(G),"selected-keys":u(K),onSelect:u(B),onSelectAll:u(E)},{columns:p((()=>[d(X,{title:"序号",width:68},{cell:p((e=>[g(h(e.rowIndex+1),1)])),_:1}),d(X,{title:"姓名","data-index":"name"}),d(X,{title:"地址","data-index":"address",ellipsis:"",tooltip:""}),d(X,{title:"比例",width:200},{cell:p((({record:e})=>{return[d(Y,{status:(t=e.proportion,t<30?"danger":t<60?"warning":"success"),percent:e.proportion/100},null,8,["status","percent"])];var t})),_:1}),d(X,{title:"状态",width:100,align:"center"},{cell:p((({record:e})=>[d(Z,{status:e.status},null,8,["status"])])),_:1}),d(X,{title:"创建时间","data-index":"createTime",width:180}),d(X,{title:"操作",width:200,align:"center",fixed:u(f)()?void 0:"right"},{cell:p((({record:e})=>[d(_,null,{default:p((()=>[d(b,{type:"primary",size:"mini",onClick:R},{default:p((()=>a[4]||(a[4]=[g("修改")]))),_:1}),d(b,{size:"mini",onClick:t=>{return n=e,void V.push({name:"DataDetailId",params:{id:n.id}});var n}},{default:p((()=>a[5]||(a[5]=[g("详情")]))),_:2},1032,["onClick"]),d(F,{type:"warning",content:"您确定要删除该项吗?",onBeforeOk:t=>{return W((()=>k({ids:[n.id]})),{content:`是否删除-${(n=e).name}?`,showModal:!1});var n}},{default:p((()=>[d(b,{type:"primary",status:"danger",size:"mini"},{default:p((()=>a[6]||(a[6]=[g("删除")]))),_:1})])),_:2},1032,["onBeforeOk"])])),_:2},1024)])),_:1},8,["fixed"])])),_:1},8,["loading","data","pagination","selected-keys","onSelect","onSelectAll"])])])])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-65cb4712"]]);export{V as default};
