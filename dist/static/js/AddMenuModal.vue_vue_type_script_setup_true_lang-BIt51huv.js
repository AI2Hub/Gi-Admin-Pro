import{_ as e}from"./index-B_JWm64F.js";import{d as l,k as a,R as d,B as t,b as u,fd as o,e as n,o as s,c as i,w as r,h as m,g as c,I as p,f7 as f,f8 as h,a as V,i as v,t as y,J as b,v as k,V as _}from"./index-JnUDrixV.js";import{g as x}from"./menu-DHkfqAem.js";import{s as w}from"./index-DG8U9wgv.js";import{u as g}from"./useForm-DBf_VAUZ.js";const U=v("span",null,"路由名称由系统自动生成：",-1),I=l({__name:"AddMenuModal",props:{menus:{default:()=>[]}},emits:["save-success"],setup(l,{expose:I,emit:M}){const j=l,q=M,S=a((()=>{const e=JSON.parse(JSON.stringify(j.menus)),l=d(e,(e=>[1,2].includes(e.type)));return t.mapTree(l,(e=>({id:e.id,title:e.title,children:e.children})))})),A={xs:24,sm:24,md:12,lg:12,xl:12,xxl:12},T={xs:12,sm:12,md:8,lg:8,xl:8,xxl:8},O=u(),F=u(""),J=u(!1),B=a((()=>!!F.value)),C=a((()=>B.value?"编辑菜单":"新增菜单")),N=u(!1),{form:R,resetForm:W}=g({type:1,icon:"",svgIcon:"",title:"",sort:0,status:1,path:"",component:"",keepAlive:!1,hidden:!0,parentId:"",redirect:"",breadcrumb:!0,showInTabs:!0,alwaysShow:!1,permission:""}),z=a((()=>o(R.path))),E={parentId:[{required:!0,message:"请选择上级菜单"}],title:[{required:!0,message:"请输入菜单标题"}],path:[{required:!0,message:"请输入路由路径"}],component:[{required:!0,message:"请输入组件路径"}],permission:[{required:!0,message:"请输入权限标识"}]},H=a((()=>{if([1,2].includes(R.type)){const{title:e,path:l}=E;return{title:e,path:l}}if(3===R.type){const{parentId:e,title:l,permission:a}=E;return{parentId:e,title:l,permission:a}}return{}})),D=()=>{var e;null==(e=O.value)||e.clearValidate()},G=()=>{var e;null==(e=O.value)||e.resetFields(),W()};I({add:()=>{F.value="",J.value=!0},edit:async e=>{J.value=!0,F.value=e;const l=await x({id:e});Object.assign(R,l.data),k(R.path)&&(N.value=!0)}});const K=async()=>{var e;try{if(await(null==(e=O.value)?void 0:e.validate()))return!1;return!!(await w(R)).data&&(_.success("模拟保存成功"),q("save-success"),!0)}catch(l){return!1}};return(l,a)=>{const d=n("a-radio"),t=n("a-radio-group"),u=n("a-form-item"),o=n("a-tree-select"),k=e,_=n("icon-question-circle-fill"),x=n("a-tooltip"),w=n("a-col"),g=n("a-row"),I=n("a-input"),M=n("a-tag"),j=n("a-switch"),q=n("a-input-number"),F=n("a-form"),W=n("a-modal");return s(),i(W,{visible:c(J),"onUpdate:visible":a[18]||(a[18]=e=>b(J)?J.value=e:null),title:c(C),width:"90%","modal-style":{maxWidth:"625px"},"body-style":{maxHeight:"70vh"},"mask-closable":!1,onBeforeOk:K,onClose:G},{default:r((()=>[m(F,{ref_key:"formRef",ref:O,model:c(R),rules:c(H),"auto-label-width":""},{default:r((()=>[m(u,{label:"菜单类型",field:"type"},{default:r((()=>[m(t,{modelValue:c(R).type,"onUpdate:modelValue":a[0]||(a[0]=e=>c(R).type=e),type:"button",disabled:c(B),onChange:D},{default:r((()=>[m(d,{value:1},{default:r((()=>[p("目录")])),_:1}),m(d,{value:2},{default:r((()=>[p("菜单")])),_:1}),m(d,{value:3},{default:r((()=>[p("按钮")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),m(u,{label:"上级菜单",field:"parentId"},{default:r((()=>[m(o,{modelValue:c(R).parentId,"onUpdate:modelValue":a[1]||(a[1]=e=>c(R).parentId=e),placeholder:"请选择上级菜单","allow-clear":"","allow-search":"",disabled:c(B),data:c(S),"field-names":{key:"id",title:"title",children:"children"}},null,8,["modelValue","disabled","data"])])),_:1}),[1,2].includes(c(R).type)?(s(),i(g,{key:0,gutter:16},{default:r((()=>[m(w,f(h(A)),{default:r((()=>[m(u,{label:"自定义图标",field:"svgIcon"},{default:r((()=>[m(k,{modelValue:c(R).svgIcon,"onUpdate:modelValue":a[2]||(a[2]=e=>c(R).svgIcon=e),type:"custom"},null,8,["modelValue"]),m(x,{content:"优先显示"},{default:r((()=>[m(_,{size:18,style:{color:"rgba(var(--warning-6))","margin-left":"8px"}})])),_:1})])),_:1})])),_:1},16),m(w,f(h(A)),{default:r((()=>[m(u,{label:"菜单图标",field:"icon"},{default:r((()=>[m(k,{modelValue:c(R).icon,"onUpdate:modelValue":a[3]||(a[3]=e=>c(R).icon=e)},null,8,["modelValue"])])),_:1})])),_:1},16)])),_:1})):V("",!0),m(u,{label:"菜单标题",field:"title"},{default:r((()=>[m(I,{modelValue:c(R).title,"onUpdate:modelValue":a[4]||(a[4]=e=>c(R).title=e),modelModifiers:{trim:!0},placeholder:"请输入菜单标题","allow-clear":"","max-length":10},null,8,["modelValue"])])),_:1}),[1,2].includes(c(R).type)?(s(),i(u,{key:1,label:"路由路径",field:"path"},{extra:r((()=>[v("div",null,[U,c(z)?(s(),i(M,{key:0},{default:r((()=>[p(y(c(z)),1)])),_:1})):V("",!0)])])),default:r((()=>[m(I,{modelValue:c(R).path,"onUpdate:modelValue":a[5]||(a[5]=e=>c(R).path=e),modelModifiers:{trim:!0},placeholder:"请输入路由路径","allow-clear":"","max-length":50},null,8,["modelValue"])])),_:1})):V("",!0),[1,2].includes(c(R).type)&&!c(N)?(s(),i(u,{key:2,label:"重定向",field:"redirect"},{default:r((()=>[m(I,{modelValue:c(R).redirect,"onUpdate:modelValue":a[6]||(a[6]=e=>c(R).redirect=e),modelModifiers:{trim:!0},placeholder:"请输入重定向地址","allow-clear":"","max-length":50},null,8,["modelValue"])])),_:1})):V("",!0),[1,2].includes(c(R).type)?(s(),i(u,{key:3,label:"是否外链",field:"isExternalUrl"},{default:r((()=>[m(t,{modelValue:c(N),"onUpdate:modelValue":a[7]||(a[7]=e=>b(N)?N.value=e:null),type:"button"},{default:r((()=>[m(d,{value:!0},{default:r((()=>[p("是")])),_:1}),m(d,{value:!1},{default:r((()=>[p("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})):V("",!0),2===c(R).type?(s(),i(u,{key:4,label:"组件路径",field:"component"},{default:r((()=>[c(N)?(s(),i(I,{key:0,modelValue:c(R).component,"onUpdate:modelValue":a[8]||(a[8]=e=>c(R).component=e),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},null,8,["modelValue"])):(s(),i(I,{key:1,modelValue:c(R).component,"onUpdate:modelValue":a[9]||(a[9]=e=>c(R).component=e),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},{prepend:r((()=>[p("@/views/")])),append:r((()=>[p(".vue")])),_:1},8,["modelValue"]))])),_:1})):V("",!0),[1,2].includes(c(R).type)?(s(),i(g,{key:5,gutter:16},{default:r((()=>[m(w,f(h(T)),{default:r((()=>[m(u,{label:"状态",field:"status"},{default:r((()=>[m(j,{modelValue:c(R).status,"onUpdate:modelValue":a[10]||(a[10]=e=>c(R).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"启用","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},16),m(w,f(h(T)),{default:r((()=>[m(u,{label:"是否隐藏",field:"hidden"},{default:r((()=>[m(j,{modelValue:c(R).hidden,"onUpdate:modelValue":a[11]||(a[11]=e=>c(R).hidden=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])])),_:1})])),_:1},16),m(w,f(h(T)),{default:r((()=>[m(u,{label:"是否缓存",field:"keepAlive"},{default:r((()=>[m(j,{modelValue:c(R).keepAlive,"onUpdate:modelValue":a[12]||(a[12]=e=>c(R).keepAlive=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])])),_:1})])),_:1},16),m(w,f(h(T)),{default:r((()=>[m(u,{label:"面包屑",field:"breadcrumb"},{default:r((()=>[m(j,{modelValue:c(R).breadcrumb,"onUpdate:modelValue":a[13]||(a[13]=e=>c(R).breadcrumb=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})])),_:1},16),m(w,f(h(T)),{default:r((()=>[1===c(R).type?(s(),i(u,{key:0,label:"总是显示",field:"alwaysShow"},{default:r((()=>[m(j,{modelValue:c(R).alwaysShow,"onUpdate:modelValue":a[14]||(a[14]=e=>c(R).alwaysShow=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):V("",!0),2===c(R).type?(s(),i(u,{key:1,label:"页签显示",field:"showInTabs"},{default:r((()=>[m(j,{modelValue:c(R).showInTabs,"onUpdate:modelValue":a[15]||(a[15]=e=>c(R).showInTabs=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):V("",!0)])),_:1},16)])),_:1})):V("",!0),3===c(R).type?(s(),i(u,{key:6,label:"权限标识",field:"permission"},{default:r((()=>[m(I,{modelValue:c(R).permission,"onUpdate:modelValue":a[16]||(a[16]=e=>c(R).permission=e),modelModifiers:{trim:!0},placeholder:"sys:btn:add","allow-clear":"","max-length":20},null,8,["modelValue"])])),_:1})):V("",!0),m(u,{label:"菜单排序",field:"sort"},{default:r((()=>[m(q,{modelValue:c(R).sort,"onUpdate:modelValue":a[17]||(a[17]=e=>c(R).sort=e),placeholder:"请输入菜单排序",min:1,mode:"button",style:{width:"120px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["visible","title"])}}});export{I as _};
