import{_ as e}from"./index-C6rL4oRZ.js";import{d as a,u as t,k as l,J as d,e as s,o as r,f as o,h as n,w as i,m as u,g as p,F as c,j as m,c as f,r as y,b as _,G as x,t as b,i as h,U as v,_ as w}from"./index-CgpQDUug.js";import{a as g}from"./regexp-LyZ7ySAN.js";import{u as I}from"./useDict-6gxUY2-H.js";const $={class:"gi-edit-table"},j=a({name:"GiEditTable",inheritAttrs:!1,__name:"GiEditTable",props:{columns:{},data:{},disabled:{default:!1}},setup(e,{expose:a}){const _=e,x=t(),b=l((()=>({tableData:_.data}))),h=d("formRef");a({formRef:h});const v=e=>e.required?"gi_column_require":"",w=e=>{const a={};return"input"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`,a.maxLength=50),"input-number"===e.type&&(a.placeholder=`请输入${e.title}`),"textarea"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`,a.maxLength=200),"select"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`),"cascader"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`),"tree-select"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`),"date-picker"===e.type&&(a.placeholder="请选择日期"),"time-picker"===e.type&&(a.allowClear=!0,a.placeholder="请选择时间"),{...a,...e.props}},g=e=>`${{input:"请输入"}[e.type]}${e.title}`;return(e,a)=>{const t=s("a-form-item"),l=s("a-table-column"),d=s("a-table"),I=s("a-form");return r(),o("div",$,[n(I,{ref_key:"formRef",ref:h,model:p(b)},{default:i((()=>[n(d,u({data:p(b).tableData,bordered:{cell:!0},pagination:!1},p(x)),{columns:i((()=>[(r(!0),o(c,null,m(_.columns,(e=>(r(),f(l,u({key:e.dataIndex,title:e.title,"data-index":e.dataIndex,"header-cell-class":v(e),ref_for:!0},e.columnProps),{cell:i((({record:a,rowIndex:l})=>[n(t,u({field:`tableData[${l}].${e.dataIndex}`,"label-col-style":{display:"none"},"wrapper-col-props":{span:24},ref_for:!0},e.formItemProps,{rules:[{required:e.required||!1,message:g(e)},...e.rules||[]]}),{default:i((()=>{return[(r(),f(y(`a-${e.type}`),u({ref_for:!0},w(e),{modelValue:a[e.dataIndex],"onUpdate:modelValue":t=>a[e.dataIndex]=t,disabled:(t={row:a,rowIndex:l,col:e},"boolean"==typeof(null==_?void 0:_.disabled)?_.disabled:"function"==typeof(null==_?void 0:_.disabled)&&_.disabled(t))}),null,16,["modelValue","onUpdate:modelValue","disabled"]))];var t})),_:2},1040,["field","rules"])])),_:2},1040,["title","data-index","header-cell-class"])))),128))])),_:1},16,["data"])])),_:1},8,["model"])])}}}),k={class:"gi_page"},C=w(a({name:"FormTable",__name:"index",setup(a){const{data:t}=I({code:"status"}),u=_(!1),c=_([{name:"张三",phone:"",address:"广州市",rate:3,status:0,num:0}]),m=l((()=>JSON.stringify(c.value,null,"\t"))),f=d("GiEditTableRef"),y=l((()=>[{type:"input",title:"姓名",dataIndex:"name",required:!0},{type:"input",title:"手机号",dataIndex:"phone",required:!0,rules:[{match:g,message:"手机号格式不正确"}]},{type:"select",title:"状态",dataIndex:"status",props:{options:t.value}},{type:"rate",title:"评分",dataIndex:"rate",columnProps:{width:200}},{type:"input-number",title:"小数",dataIndex:"num",columnProps:{width:120}},{type:"textarea",title:"地址",dataIndex:"address",props:{autoSize:!0,maxLength:200,showWordLimit:!0},columnProps:{width:250}}])),w=()=>{c.value.push({name:"",phone:"",address:"",rate:0,status:0,num:0})},$=()=>{var e,a,t,l;null==(a=null==(e=f.value)?void 0:e.formRef)||a.resetFields(),null==(l=null==(t=f.value)?void 0:t.formRef)||l.clearValidate()},C=async()=>{var e,a;const t=await(null==(a=null==(e=f.value)?void 0:e.formRef)?void 0:a.validate());if(t){const e=Object.values(t);v.warning(e[0].message)}else v.success("验证通过~")},R=({rowIndex:e,col:a})=>!!u.value||"name"===a.dataIndex&&0===e;return(a,t)=>{const l=s("a-button"),d=s("icon-plus"),_=s("a-space"),v=s("a-row"),g=j,I=e,q=s("a-card");return r(),o("div",k,[n(q,{title:"编辑表格"},{default:i((()=>[n(v,{justify:"end"},{default:i((()=>[n(_,{wrap:""},{default:i((()=>[n(l,{type:"primary",status:p(u)?"success":"warning",onClick:t[0]||(t[0]=e=>u.value=!p(u))},{default:i((()=>[x(b(p(u)?"编辑":"只读"),1)])),_:1},8,["status"]),n(l,{type:"primary",onClick:w},{icon:i((()=>[n(d)])),default:i((()=>[t[1]||(t[1]=h("span",null,"新增",-1))])),_:1})])),_:1})])),_:1}),n(g,{ref_key:"GiEditTableRef",ref:f,scroll:{minWidth:900},columns:p(y),data:p(c),disabled:R},null,8,["columns","data"]),n(v,{justify:"end",class:"gi_mt"},{default:i((()=>[n(_,{wrap:""},{default:i((()=>[n(l,{onClick:$},{default:i((()=>t[2]||(t[2]=[x("重置")]))),_:1}),n(l,{type:"primary",onClick:C},{default:i((()=>t[3]||(t[3]=[x("验证并提交")]))),_:1})])),_:1})])),_:1}),n(I,{"code-json":p(m)},null,8,["code-json"])])),_:1})])}}}),[["__scopeId","data-v-01d3a36c"]]);export{C as default};
