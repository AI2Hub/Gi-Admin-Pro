import{d as e,f as t,o as n,a,w as l,i as o,m as s,j as i,C as r,_ as c,n as d,S as p,a6 as u,h as m,D as f,t as g,V as h,a7 as b,a4 as y}from"./index-J7mQeAxE.js";import{_ as w}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-BQrIti1C.js";import{u as _}from"./index-D6uQfBwt.js";import x from"./index-BF1HZWoL.js";import{u as k}from"./useTable-BP458rfx.js";import{d as C,g as v}from"./index-3ztv81Vn.js";import{u as D}from"./useDict-BicQCMsR.js";import{_ as P}from"./index-BZftcr9o.js";const T={class:"gi-left-right-pane__left"},j={class:"gi-left-right-pane__right"},V=c(e({name:"GiLeftRightPane",__name:"index",props:{leftColProps:{default:()=>({})},rightColProps:{default:()=>({})}},setup(e){const c=e;return(e,d)=>{const p=t("a-col"),u=t("a-row");return n(),a(u,{class:"gi-left-right-pane",align:"stretch",gutter:14},{default:l((()=>[o(p,s({class:"h-full overflow-hidden",xs:0,sm:8,md:7,lg:6,xl:5,xxl:4,flex:"260px"},c.leftColProps),{default:l((()=>[i("div",T,[r(e.$slots,"left",{},void 0,!0)])])),_:3},16),o(p,s({class:"h-full overflow-hidden",xs:24,sm:16,md:17,lg:18,xl:19,xxl:20,flex:"1"},c.rightColProps),{default:l((()=>[i("div",j,[r(e.$slots,"default",{},void 0,!0)])])),_:3},16)])),_:3})}}}),[["__scopeId","data-v-fe87b46c"]]),I=e({__name:"Pane1",setup(e){const{width:s}=_(),i=d(),{data:r}=D({code:"status"}),c=p({name:"",status:""}),{loading:T,tableData:j,getTableData:I,pagination:S,selectedKeys:G,select:z,selectAll:A,handleDelete:M,fixed:E}=k((e=>v({...c,...e})),{immediate:!1,formatResult:e=>e.map((e=>({...e,isEdit:!1})))});u((()=>{I()}));const K=()=>{i.push({path:"/data/form",query:{id:"ID123456"}})},R=()=>{if(!G.value.length)return h.warning("请选择删除项！");M((()=>C({ids:G.value})),{successTip:"批量删除成功！"})},L=()=>{if(!G.value.length)return h.warning("请勾选数据");h.success("点击了导出")},$=()=>{b.open({title:"数据结构",content:()=>y(P,{codeJson:'\n<template>\n  <GiLeftRightPane>\n    <template #left>\n      <a-card title="数据分类" :bordered="false" class="gi_card flex-1">\n        <CateTree placeholder="请输入搜索关键词" @node-click="pagination.onChange(1)"></CateTree>\n      </a-card>\n    </template>\n\n    <a-card title="数据列表" :bordered="false" :header-style="{ display: \'none\' }" class="gi_card flex-1">\n      <a-row justify="space-between">\n        <a-space wrap>\n          <a-button type="primary">\n            <template #icon><icon-plus /></template>\n          </a-button>\n          <a-button type="primary" status="danger" @click="onMulDelete">\n            <template #icon><icon-delete /></template>\n            <template #default>删除</template>\n          </a-button>\n          <a-button type="primary" status="success" @click="onExport">\n            <template #icon><icon-export /></template>\n          </a-button>\n          <a-button type="primary" status="warning" @click="onViewCode">\n            <template #icon><icon-code /></template>\n          </a-button>\n        </a-space>\n\n        <a-space wrap>\n          <a-select v-model="form.status" class="gi_select_input" :options="options" placeholder="请选择"\n            allow-clear></a-select>\n          <a-input-group>\n            <a-input v-model="form.name" placeholder="请输入搜索关键词" allow-clear> </a-input>\n            <a-button type="primary" @click="getTableData">\n              <icon-search />\n            </a-button>\n          </a-input-group>\n          <a-button type="primary" @click="getTableData">\n            <template #icon><icon-refresh /></template>\n          </a-button>\n        </a-space>\n      </a-row>\n\n      <a-table class="gi_table" row-key="id" :loading="loading" :bordered="{ cell: true }" :data="tableData"\n        :scroll="{ x: \'100%\', y: \'100%\', minWidth: 1000 }" :row-selection="{ type: \'checkbox\', showCheckedAll: true }"\n        :pagination="pagination" :selected-keys="selectedKeys" @select="select" @select-all="selectAll">\n        <template #columns>\n          <a-table-column title="序号" :width="68">\n            <template #cell="cell">{{ cell.rowIndex + 1 }}</template>\n          </a-table-column>\n          <a-table-column title="姓名" data-index="name"></a-table-column>\n          <a-table-column title="地址" data-index="address" ellipsis tooltip></a-table-column>\n          <a-table-column title="比例" :width="200">\n            <template #cell="{ record }">\n              <a-progress :status="getProportionColor(record.proportion)" :percent="record.proportion / 100" />\n            </template>\n          </a-table-column>\n          <a-table-column title="状态" :width="100" align="center">\n            <template #cell="{ record }">\n              <GiCellStatus :status="record.status"></GiCellStatus>\n            </template>\n          </a-table-column>\n          <a-table-column title="创建时间" data-index="createTime" :width="180"></a-table-column>\n          <a-table-column title="操作" :width="200" align="center" :fixed="fixed">\n            <template #cell="{ record }">\n              <a-space>\n                <a-button type="primary" size="mini" @click="onEdit">修改</a-button>\n                <a-button size="mini" @click="onDetail(record)">详情</a-button>\n                <a-popconfirm type="warning" content="您确定要删除该项吗?" @before-ok="onDelete(record)">\n                  <a-button type="primary" status="danger" size="mini">删除</a-button>\n                </a-popconfirm>\n              </a-space>\n            </template>\n          </a-table-column>\n        </template>\n      </a-table>\n    </a-card>\n  </GiLeftRightPane>\n</template>\n\n<script setup lang="ts">\nimport { Drawer, Message } from \'@arco-design/web-vue\'\nimport { useWindowSize } from \'@vueuse/core\'\nimport CateTree from \'./CateTree/index.vue\'\nimport Pane1Json from \'./code/pane1-json\'\nimport { useTable } from \'@/hooks\'\nimport { type PersonItem, deletePerson, getPersonList } from \'@/apis/person\'\nimport { useDict } from \'@/hooks/app\'\nimport GiCodeView from \'@/components/GiCodeView/index.vue\'\n\nconst { width } = useWindowSize()\nconst router = useRouter()\n\nconst { data: options } = useDict({ code: \'status\' })\nconst form = reactive({\n  name: \'\',\n  status: \'\'\n})\n\n// 这里使用了表格hooks：useTable, 节省了大量代码\nconst { loading, tableData, getTableData, pagination, selectedKeys, select, selectAll, handleDelete, fixed } = useTable(\n  (page) => getPersonList({ ...form, ...page }),\n  { immediate: false, formatResult: (data) => data.map((i) => ({ ...i, isEdit: false })) }\n)\n\n// 比例进度条颜色\nconst getProportionColor = (proportion: number) => {\n  if (proportion < 30) return \'danger\'\n  if (proportion < 60) return \'warning\'\n  return \'success\'\n}\n\nonActivated(() => {\n  getTableData()\n})\n\nconst onEdit = () => {\n  router.push({ path: \'/data/form\', query: { id: \'ID123456\' } })\n}\n\nconst onDetail = (item: PersonItem) => {\n  router.push({ name: \'DataDetailId\', params: { id: item.id } })\n}\n\n// 删除\nconst onDelete = (item: PersonItem) => {\n  return handleDelete(() => deletePerson({ ids: [item.id] }), { content: `是否删除-${item.name}?`, showModal: false })\n}\n\n// 批量删除\nconst onMulDelete = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请选择删除项！\')\n  }\n  handleDelete(() => deletePerson({ ids: selectedKeys.value as string[] }), { successTip: \'批量删除成功！\' })\n}\n\nconst onExport = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请勾选数据\')\n  }\n  Message.success(\'点击了导出\')\n}\n\nconst onViewCode = () => {\n  Drawer.open({\n    title: \'数据结构\',\n    content: () => h(GiCodeView, { codeJson: Pane1Json, type: \'vue\' }),\n    width: width.value < 500 ? \'100%\' : 800\n  })\n}\n<\/script>\n\n<style lang="scss" scoped></style>\n',type:"vue"}),width:s.value<500?"100%":800})};return(e,s)=>{const d=t("a-card"),p=t("icon-plus"),u=t("a-button"),h=t("icon-delete"),b=t("icon-export"),y=t("icon-code"),_=t("a-space"),k=t("a-select"),v=t("a-input"),D=t("icon-search"),P=t("a-input-group"),J=t("icon-refresh"),W=t("a-row"),q=t("a-table-column"),B=t("a-progress"),N=w,O=t("a-popconfirm"),U=t("a-table"),X=V;return n(),a(X,null,{left:l((()=>[o(d,{title:"数据分类",bordered:!1,class:"gi_card flex-1"},{default:l((()=>[o(x,{placeholder:"请输入搜索关键词",onNodeClick:s[0]||(s[0]=e=>m(S).onChange(1))})])),_:1})])),default:l((()=>[o(d,{title:"数据列表",bordered:!1,"header-style":{display:"none"},class:"gi_card flex-1"},{default:l((()=>[o(W,{justify:"space-between"},{default:l((()=>[o(_,{wrap:""},{default:l((()=>[o(u,{type:"primary"},{icon:l((()=>[o(p)])),_:1}),o(u,{type:"primary",status:"danger",onClick:R},{icon:l((()=>[o(h)])),default:l((()=>s[3]||(s[3]=[f("删除")]))),_:1}),o(u,{type:"primary",status:"success",onClick:L},{icon:l((()=>[o(b)])),_:1}),o(u,{type:"primary",status:"warning",onClick:$},{icon:l((()=>[o(y)])),_:1})])),_:1}),o(_,{wrap:""},{default:l((()=>[o(k,{modelValue:m(c).status,"onUpdate:modelValue":s[1]||(s[1]=e=>m(c).status=e),class:"gi_select_input",options:m(r),placeholder:"请选择","allow-clear":""},null,8,["modelValue","options"]),o(P,null,{default:l((()=>[o(v,{modelValue:m(c).name,"onUpdate:modelValue":s[2]||(s[2]=e=>m(c).name=e),placeholder:"请输入搜索关键词","allow-clear":""},null,8,["modelValue"]),o(u,{type:"primary",onClick:m(I)},{default:l((()=>[o(D)])),_:1},8,["onClick"])])),_:1}),o(u,{type:"primary",onClick:m(I)},{icon:l((()=>[o(J)])),_:1},8,["onClick"])])),_:1})])),_:1}),o(U,{class:"gi_table","row-key":"id",loading:m(T),bordered:{cell:!0},data:m(j),scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:m(S),"selected-keys":m(G),onSelect:m(z),onSelectAll:m(A)},{columns:l((()=>[o(q,{title:"序号",width:68},{cell:l((e=>[f(g(e.rowIndex+1),1)])),_:1}),o(q,{title:"姓名","data-index":"name"}),o(q,{title:"地址","data-index":"address",ellipsis:"",tooltip:""}),o(q,{title:"比例",width:200},{cell:l((({record:e})=>{return[o(B,{status:(t=e.proportion,t<30?"danger":t<60?"warning":"success"),percent:e.proportion/100},null,8,["status","percent"])];var t})),_:1}),o(q,{title:"状态",width:100,align:"center"},{cell:l((({record:e})=>[o(N,{status:e.status},null,8,["status"])])),_:1}),o(q,{title:"创建时间","data-index":"createTime",width:180}),o(q,{title:"操作",width:200,align:"center",fixed:m(E)},{cell:l((({record:e})=>[o(_,null,{default:l((()=>[o(u,{type:"primary",size:"mini",onClick:K},{default:l((()=>s[4]||(s[4]=[f("修改")]))),_:1}),o(u,{size:"mini",onClick:t=>{return n=e,void i.push({name:"DataDetailId",params:{id:n.id}});var n}},{default:l((()=>s[5]||(s[5]=[f("详情")]))),_:2},1032,["onClick"]),o(O,{type:"warning",content:"您确定要删除该项吗?",onBeforeOk:t=>{return M((()=>C({ids:[n.id]})),{content:`是否删除-${(n=e).name}?`,showModal:!1});var n}},{default:l((()=>[o(u,{type:"primary",status:"danger",size:"mini"},{default:l((()=>s[6]||(s[6]=[f("删除")]))),_:1})])),_:2},1032,["onBeforeOk"])])),_:2},1024)])),_:1},8,["fixed"])])),_:1},8,["loading","data","pagination","selected-keys","onSelect","onSelectAll"])])),_:1})])),_:1})}}});export{I as _};
