import{_ as ke}from"./GiTitle.69c38765.js";import{ew as xe,r as C,s as Fe,v as J,d as O,q as le,o as k,m as z,w as t,es as ce,ey as De,j as x,a as b,n as be,el as Be,et as Ee,_ as K,h as Y,c as j,G as L,i as n,b as e,ei as X,k as F,eC as $e,eD as Ae,L as Ve,em as re,ej as Ie,J as ae,K as Z,I as ee,z as Te,p as ze,e as Se,u as Ne,er as Me,M as Oe}from"./index.08f7ddde.js";import"./index.463d26de.js";import{u as Pe}from"./usePagination.df2035b1.js";import"./viewer.1c0b8e9f.js";import{o as Re,c as je,f as Ue}from"./index.6981f2df.js";import{G as Q,a as He}from"./GiOptionItem.378049ae.js";import{g as Ge}from"./index.378887e7.js";const We="/mock";function qe(){return xe.get(`${We}/cate/tree`)}function Le(r,m,c={alignPoint:!1}){const o=C(!1),f=C(0),i=C(0),a=d=>{o.value=d},h=()=>{const d={};return r.clientX>window.innerWidth-i.value?d.right=c.alignPoint?window.innerWidth-r.clientX-f.value/2+"px":window.innerWidth-r.clientX+"px":d.left=c.alignPoint?r.clientX+f.value/2+"px":r.clientX+"px",r.clientY>window.innerHeight-i.value?(d.bottom=window.innerHeight-r.clientY+"px",d["transform-origin"]="center bottom"):(d.top=r.clientY+2+"px",d["transform-origin"]="center top"),d["z-index"]=999,d};return Fe(()=>{o.value=!0,J(()=>{!m||(i.value=m==null?void 0:m.offsetHeight,f.value=m==null?void 0:m.offsetWidth,h())})}),{visible:o,setVisible:a,getStyle:h}}function Xe(r,m="\u65B0\u5EFA\u5206\u7C7B"){let c=0;for(let o=0;o<r.length+1;o++)if(!r.includes(`${m}${o+1}`)){c=o+1;break}return`${m}${c}`}const Je=O({name:"GiContextMenu"}),Ye=O({...Je,props:{event:null,options:null,ignoreRefs:null},emits:["close"],setup(r,{expose:m,emit:c}){const o=r,f=C(null),{visible:i,setVisible:a,getStyle:h}=Le(o.event,f,o.options);Re(f,()=>{a(!1),c("close")},{capture:!1,ignore:o.ignoreRefs});const{width:d,height:V}=je();return le(()=>[d.value,V.value],()=>{a(!1),c("close")}),m({visible:i,onHidden:()=>{a(!1),c("close")}}),(y,D)=>(k(),z(Ee,{name:"slide-dynamic-origin"},{default:t(()=>[ce(b("div",{class:"gi-context-menu",ref_key:"elRef",ref:f,style:Be(x(h)())},[be(y.$slots,"default",{},void 0,!0)],4),[[De,x(i)]])]),_:3}))}});const Ke=K(Ye,[["__scopeId","data-v-4ada3c17"]]),Qe={id:"movetree",ref:"moveTreeRef",class:"ztree move-tree"},Ze=O({__name:"MoveTree",props:{treeData:{type:Array,default:()=>[]}},emits:["node-click"],setup(r,{emit:m}){const c=r,o=C(null),f=Y({callback:{onClick:(a,h,d)=>{i(a,h,d)}}});le(c.treeData,()=>{J(()=>{var a;o.value=$.fn.zTree.init($("#movetree"),f,c.treeData),(a=o.value)==null||a.expandAll(!0)})},{deep:!0,immediate:!0});function i(a,h,d){m("node-click",d)}return(a,h)=>(k(),j("ul",Qe,null,512))}}),et=F("\u65B0\u589E"),tt=F("\u91CD\u547D\u540D"),nt=F(" \u79FB\u52A8 "),ot=F("\u5220\u9664"),at=O({__name:"Menu",props:{event:null,fileInfo:null,treeData:null,onClose:null,onClick:null},setup(r,{expose:m}){const c=r,o=C(null),f=C(null),i=C([f]),a=C(!1),h=L(()=>c.fileInfo.id!==""),d=L(()=>c.fileInfo.id!=="root"),V=L(()=>c.fileInfo.id!=="root"),I=L(()=>c.fileInfo.id!=="root"),y=()=>{a.value=!1,c.onClose()},D=E=>{if(E==="move")return a.value=!a.value,!1;J(()=>{var g;c.onClick(E),(g=o.value)==null||g.onHidden()})},B=()=>{var E;(E=o.value)==null||E.onHidden()};return m({menuRef:o,showMoveTreePopup:a,onClose:y,onClickItem:D}),(E,g)=>{const S=n("a-popover");return k(),z(Ke,{ref_key:"menuRef",ref:o,event:r.event,ignoreRefs:i.value,onClose:y},{default:t(()=>[e(He,{width:110,ref:"optionRef",style:{position:"relative"}},{default:t(()=>[x(h)?(k(),z(Q,{key:0,icon:"IconPlusCircle",onClick:g[0]||(g[0]=u=>D("add"))},{default:t(()=>[et]),_:1})):X("",!0),x(d)?(k(),z(Q,{key:1,icon:"IconEdit",onClick:g[1]||(g[1]=u=>D("rename"))},{default:t(()=>[tt]),_:1})):X("",!0),e(S,{position:"right",trigger:"click","content-style":{padding:0,overflow:"hidden"},"unmount-on-close":!1,"popup-visible":a.value},{content:t(()=>[b("section",{class:"move-tree-box",ref_key:"moveTreeBoxRef",ref:f},[e(Ze,{"tree-data":r.treeData,onNodeClick:B},null,8,["tree-data"])],512)]),default:t(()=>[x(V)?(k(),z(Q,{key:0,more:"",icon:"IconExport",active:a.value,onClick:g[2]||(g[2]=u=>D("move"))},{default:t(()=>[nt]),_:1},8,["active"])):X("",!0)]),_:1},8,["popup-visible"]),x(I)?(k(),z(Q,{key:2,icon:"IconDelete",onClick:g[3]||(g[3]=u=>D("delete"))},{default:t(()=>[ot]),_:1})):X("",!0)]),_:1},512)]),_:1},8,["event","ignoreRefs"])}}});const lt=K(at,[["__scopeId","data-v-e36b4e3d"]]);let R=null,G=null;function ut(r,m,c){return new Promise(o=>{f(),G=document.createElement("div"),document.body.appendChild(G),R=$e(lt,{event:r,fileInfo:m,treeData:c,onClick:i=>{o({mode:i,fileInfo:m}),setTimeout(()=>{f()},360)},onClose:()=>{setTimeout(()=>{f()},360)}}),R.use(Ae),R.use(Ve),R.mount(G);function f(){R!==null&&(R.unmount(),R=null),G!==null&&(document.body.removeChild(G),G=null)}})}const oe="/gi-demo/assets/com-file-open.a82dbda1.svg",q="/gi-demo/assets/com-file-close.e0ebbcc4.svg",st="/gi-demo/assets/com-file.9070581a.svg",it={class:"cate-tree"},ct={class:"search-wrap"},rt={class:"wrap"},dt=O({__name:"index",props:{type:{type:Number,default:1},placeholder:{type:String,default:"\u8BF7\u8F93\u5165\u5173\u952E\u8BCD"}},emits:["node-click"],setup(r,{emit:m}){const c=C(!1),o=C(""),f=C(null),i=C([]),a=C(null),h=C(null),d=(u,_,s)=>{console.log("\u70B9\u51FB\u8282\u70B9",s),h.value=s,m("node-click")},V=Y({callback:{onRightClick:(u,_,s)=>{console.log("\u9F20\u6807\u53F3\u952E",s),s&&(h.value=s,ut(u,s,i.value).then(l=>{console.log("res",l),l.mode==="add"&&D(),l.mode==="rename"&&B(),l.mode==="delete"&&E()}))},onClick:(u,_,s)=>{d(u,_,s)}}}),I=u=>{if(!u.length)return;function _(s){s.forEach(l=>{l.children&&l.children.length?(l.iconOpen=oe,l.iconClose=q,_(l.children)):(l.children=null,l.iconOpen=oe,l.iconClose=q,l.icon=q,l.type==null&&(l.icon=st))})}_(u)};(async()=>{try{c.value=!0;const u=await qe();if(u.success){const _=u.data;I(_),i.value=_,J(()=>{var s;a.value=$.fn.zTree.init($("#treeDemo"),V,i.value),(s=a.value)==null||s.expandAll(!0)})}}catch(u){return u}finally{c.value=!1}})();const D=()=>{var w,N,U;const u=((w=h.value)==null?void 0:w.children)||[];let _="\u65B0\u5EFA\u5206\u7C7B1";if(u&&u.length){const M=u.map(W=>W.name);_=Xe(M,"\u65B0\u5EFA\u5206\u7C7B")}const s=new Date().getTime().toString(),l={id:s,name:_,children:null,iconOpen:oe,iconClose:q,icon:q,isParent:!1};(N=a.value)==null||N.addNodes(h.value||{},l,!0);const p=(U=a.value)==null?void 0:U.getNodesByParam("id",s);setTimeout(()=>{var M;(M=a.value)==null||M.editName(p[0])},100)},B=()=>{J(()=>{var _,s,l;const u=(s=a.value)==null?void 0:s.getNodesByParam("id",(_=h.value)==null?void 0:_.id);(l=a.value)==null||l.editName(u[0])})},E=()=>{re.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",hideCancel:!1})},g=(u,_)=>{let s=!1;if(u.name.indexOf(_)>-1&&(s=!0),u.children){const l=u.children;for(let p=0;p<l.length;p++){const w=l[p];g(w,_)?s=!0:l.splice(p--,1)}}return s},S=()=>{var _,s;let u=o.value;if(!u)a.value=$.fn.zTree.init($("#treeDemo"),V,i.value),(_=a.value)==null||_.expandAll(!0);else{const l=JSON.parse(JSON.stringify(i.value));for(let p=0;p<l.length;p++)g(l[p],u)||l.splice(p--,1);a.value=$.fn.zTree.init($("#treeDemo"),V,l),(s=a.value)==null||s.expandAll(!0)}};return(u,_)=>{const s=n("icon-search"),l=n("a-input");return k(),j("div",it,[b("div",ct,[e(l,{"allow-clear":"",maxlength:20,placeholder:r.placeholder,modelValue:o.value,"onUpdate:modelValue":_[0]||(_[0]=p=>o.value=p),onInput:S,onClear:S},{prefix:t(()=>[e(s)]),_:1},8,["placeholder","modelValue"])]),b("div",rt,[b("ul",{id:"treeDemo",ref_key:"treeRef",ref:f,class:"ztree cate-ztree"},null,512)])])}}});const _t=K(dt,[["__scopeId","data-v-f49d6ff3"]]),ue=r=>(ze("data-v-429f348f"),r=r(),Se(),r),pt=ue(()=>b("div",null,"\u4EC5\u652F\u6301\u4E2D\u6587\u59D3\u540D",-1)),mt=F("\u5173\u95ED"),ft=F("\u5F00\u542F"),vt=ue(()=>b("span",null,"\u6743\u9650\u914D\u7F6E",-1)),gt=ue(()=>b("span",null,"\u81EA\u5B9A\u4E49\u7BA1\u7406\u5458\u3001\u7F16\u8F91\u8005\u7684\u6743\u9650\uFF0C \u70B9\u51FB",-1)),ht=F("\u4E86\u89E3\u66F4\u591A\u6743\u9650"),yt=F("\u7BA1\u7406\u5458"),Ct=F("\u7F16\u8F91\u8005"),wt=O({__name:"EditDialog",props:{modelValue:{type:Boolean,default:!1},formData:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(r,{emit:m}){const c=r,o=Ue(c,"modelValue",m),f=[{name:"\u65B0\u589E"},{name:"\u7F16\u8F91"},{name:"\u91CD\u547D\u540D"},{name:"\u5206\u4EAB"},{name:"\u5220\u9664"}],i=Y({name:"",address:"",status:!1}),a=Y({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D"},{minLength:1,maxLength:4,message:"\u540D\u5B57\u6700\u957F\u4E0D\u8D85\u8FC74\u4E2A\u5B57\u7B26"}],status:[{required:!0}]}),h=L(()=>!!c.formData.id);le(o,()=>{const{name:I,address:y,status:D}=c.formData;i.name=I,i.address=y,i.status=D||!1});const d=()=>{o.value=!1},V=()=>{o.value=!1};return(I,y)=>{const D=n("a-input"),B=n("a-form-item"),E=n("a-radio"),g=n("a-radio-group"),S=n("a-form"),u=n("a-row"),_=n("icon-question-circle-fill"),s=n("a-link"),l=n("a-tooltip"),p=n("a-space"),w=n("icon-right"),N=n("a-checkbox"),U=n("a-checkbox-group"),M=n("a-collapse-item"),W=n("a-collapse"),T=n("a-modal");return k(),z(T,{visible:x(o),"onUpdate:visible":y[3]||(y[3]=A=>Te(o)?o.value=A:null),title:x(h)?"\u7F16\u8F91":"\u65B0\u589E",onOk:V,onCancel:d},{default:t(()=>[e(u,{justify:"center"},{default:t(()=>[e(S,{ref:"formRef",model:i,size:"medium","auto-label-width":"",style:{width:"auto"}},{default:t(()=>[e(B,{field:"name",label:"\u59D3\u540D",rules:a.name},{extra:t(()=>[pt]),default:t(()=>[e(D,{modelValue:i.name,"onUpdate:modelValue":y[0]||(y[0]=A=>i.name=A),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",style:{width:"300px"}},null,8,["modelValue"])]),_:1},8,["rules"]),e(B,{field:"address",label:"\u5730\u5740"},{default:t(()=>[e(D,{modelValue:i.address,"onUpdate:modelValue":y[1]||(y[1]=A=>i.address=A),placeholder:"\u8BF7\u8F93\u5165\u5730\u5740",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),e(B,{field:"status",label:"\u72B6\u6001",rules:a.status},{default:t(()=>[e(g,{modelValue:i.status,"onUpdate:modelValue":y[2]||(y[2]=A=>i.status=A)},{default:t(()=>[e(E,{value:!1},{default:t(()=>[mt]),_:1}),e(E,{value:!0},{default:t(()=>[ft]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1}),e(W,{bordered:!1,"default-active-key":["1"]},{default:t(()=>[e(M,{"show-expand-icon":!0,key:"1"},{header:t(()=>[e(p,null,{default:t(()=>[vt,e(l,{position:"right","content-style":{width:"200px"}},{content:t(()=>[gt,e(s,{type:"primary",hoverable:!1},{default:t(()=>[ht]),_:1})]),default:t(()=>[e(_,{style:{color:"rgb(var(--warning-6))"}})]),_:1})]),_:1})]),"expand-icon":t(({active:A})=>[e(w,{class:Ie({gi_rotate_90deg:A})},null,8,["class"])]),default:t(()=>[(k(),j(ee,null,ae(f,(A,te)=>e(u,{justify:"space-between",key:te},{default:t(()=>[b("span",null,Z(A.name),1),e(U,null,{default:t(()=>[e(N,{value:"1"},{default:t(()=>[yt]),_:1}),e(N,{value:"2"},{default:t(()=>[Ct]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["visible","title"])}}});const kt=K(wt,[["__scopeId","data-v-429f348f"]]),ie=[{name:"\u7981\u7528",value:0,color:"#f53f3f"},{name:"\u542F\u7528",value:1,color:"#00b42a"}],xt={class:"manage"},Ft={class:"tab"},Dt={class:"gi_lr_page wrap"},bt={class:"left"},Bt={class:"right"},Et={class:"content"},$t=F("\u5220\u9664"),At={class:"table-box"},Vt=F("\u4FEE\u6539"),It=F("\u8BE6\u60C5"),Tt=F("\u5220\u9664"),zt=O({name:"QuotaManage"}),St=O({...zt,setup(r){const m=Ne(),{current:c,pageSize:o,total:f,changeCurrent:i,changePageSize:a,setTotal:h}=Pe(()=>{B()}),d=Y({name:"",status:""}),V=C("2"),I=C([]),y=C(!1),D=p=>p<30?"danger":p<60?"warning":"success",B=async()=>{try{y.value=!0;const p=await Ge({current:c.value,pageSize:o.value,...d});I.value=p.data.list,h(p.data.total)}catch(p){return p}finally{y.value=!1}};B();const E=()=>{re.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",hideCancel:!1,onOk:()=>{I.value=[]}})},g=C(!1),S=C({}),u=p=>{S.value=p,g.value=!0},_=()=>{g.value=!0},s=()=>{m.push({path:"/quota/detail"})},l=p=>{Oe.success("\u5220\u9664\u6210\u529F"),B()};return(p,w)=>{const N=n("a-tab-pane"),U=n("a-tabs"),M=ke,W=n("icon-plus"),T=n("a-button"),A=n("icon-delete"),te=n("icon-download"),ne=n("a-space"),de=n("a-option"),_e=n("a-select"),pe=n("a-input"),me=n("icon-search"),fe=n("a-input-group"),ve=n("icon-refresh"),se=n("a-row"),P=n("a-table-column"),ge=n("a-progress"),he=n("a-tag"),ye=n("a-popconfirm"),Ce=n("a-table"),we=Me("loading");return k(),j("div",xt,[b("section",Ft,[e(U,{"hide-content":"",size:"medium","active-key":V.value,"onUpdate:active-key":w[0]||(w[0]=v=>V.value=v)},{default:t(()=>[e(N,{key:"1",title:"\u5468\u671F\u7BA1\u7406"}),e(N,{key:"2",title:"\u7EF4\u5EA6\u7BA1\u7406"}),e(N,{key:"3",title:"\u5355\u4F4D\u7BA1\u7406"})]),_:1},8,["active-key"])]),b("section",Dt,[b("div",bt,[e(M,{title:"\u6307\u6807\u5206\u7C7B"}),e(_t,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD",onNodeClick:w[1]||(w[1]=v=>x(i)(1))})]),b("div",Bt,[e(M,{title:"\u6307\u6807\u5217\u8868"}),b("div",Et,[e(se,{justify:"space-between",style:{"margin-bottom":"12px"}},{default:t(()=>[e(ne,null,{default:t(()=>[e(T,{type:"primary",onClick:_},{icon:t(()=>[e(W)]),_:1}),e(T,{type:"primary",status:"danger",onClick:E},{icon:t(()=>[e(A)]),default:t(()=>[$t]),_:1}),e(T,{type:"primary",status:"success"},{icon:t(()=>[e(te)]),_:1})]),_:1}),e(ne,null,{default:t(()=>[e(_e,{modelValue:d.status,"onUpdate:modelValue":w[2]||(w[2]=v=>d.status=v),class:"gi_select_input",placeholder:"\u8BF7\u9009\u62E9","allow-clear":""},{default:t(()=>[(k(!0),j(ee,null,ae(x(ie),v=>(k(),z(de,{key:v.value,value:v.value},{default:t(()=>[F(Z(v.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),e(fe,null,{default:t(()=>[e(pe,{modelValue:d.name,"onUpdate:modelValue":w[3]||(w[3]=v=>d.name=v),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD","allow-clear":""},null,8,["modelValue"]),e(T,{type:"primary",onClick:B},{default:t(()=>[e(me)]),_:1})]),_:1}),e(T,{type:"primary",onClick:B},{icon:t(()=>[e(ve)]),_:1})]),_:1})]),_:1}),b("section",At,[ce((k(),z(Ce,{"row-key":"id",bordered:{cell:!0},data:I.value,scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:{showPageSize:!0,total:x(f),current:x(c),pageSize:x(o)},onPageChange:x(i),onPageSizeChange:x(a)},{columns:t(()=>[e(P,{title:"\u5E8F\u53F7",width:68},{cell:t(v=>[F(Z(v.rowIndex+1),1)]),_:1}),e(P,{title:"\u59D3\u540D","data-index":"name"}),e(P,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"startTime",width:180}),e(P,{title:"\u5730\u5740","data-index":"address",ellipsis:"",tooltip:""}),e(P,{title:"\u6BD4\u4F8B",width:200},{cell:t(({record:v})=>[e(ge,{status:D(v.proportion),percent:v.proportion/100},null,8,["status","percent"])]),_:1}),e(P,{title:"\u72B6\u6001",width:100,align:"center"},{cell:t(({record:v})=>[(k(!0),j(ee,null,ae(x(ie),H=>(k(),j(ee,{key:H.value},[H.value===v.status?(k(),z(he,{key:0,color:H.color},{default:t(()=>[F(Z(H.name),1)]),_:2},1032,["color"])):X("",!0)],64))),128))]),_:1}),e(P,{title:"\u64CD\u4F5C",width:200,align:"center"},{cell:t(({record:v})=>[e(se,{justify:"center"},{default:t(()=>[e(ne,null,{default:t(()=>[e(T,{type:"primary",size:"mini",onClick:H=>u(v)},{default:t(()=>[Vt]),_:2},1032,["onClick"]),e(T,{size:"mini",onClick:s},{default:t(()=>[It]),_:1}),e(ye,{type:"warning",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u9879\u5417?",onOk:H=>l(v.id)},{default:t(()=>[e(T,{type:"primary",status:"danger",size:"mini"},{default:t(()=>[Tt]),_:1})]),_:2},1032,["onOk"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","pagination","onPageChange","onPageSizeChange"])),[[we,y.value]])])])]),e(kt,{modelValue:g.value,"onUpdate:modelValue":w[4]||(w[4]=v=>g.value=v),"form-data":S.value},null,8,["modelValue","form-data"])])])}}});const Gt=K(St,[["__scopeId","data-v-fe3a9c22"]]);export{Gt as default};
