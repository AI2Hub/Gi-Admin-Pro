import{d as e,b as l,U as o,k as a,ad as d,P as t,e as u,o as i,c as n,w as p,h as s,m as r,f as m,F as f,j as c,D as V,H as v,f7 as y,f8 as h,a as b,g as k,ap as U,I as w,t as x}from"./index-4GaN-tSn.js";const _=e({__name:"GiForm",props:{modelValue:{},options:{},columns:{}},emits:["update:modelValue","search","reset"],setup(e,{expose:_,emit:g}){var $;const q=e,F=g,j=(e,l)=>{F("update:modelValue",Object.assign(q.modelValue,{[l]:e}))},C=l((null==($=q.options.fold)?void 0:$.defaultCollapsed)??!1),E=l();_({formRef:E});const O=e=>void 0!==e&&("boolean"==typeof e?e:"function"==typeof e?e(q.modelValue):void 0),B=o({});q.columns.forEach((e=>{e.request&&"function"==typeof e.request&&(null==e?void 0:e.init)&&e.request(q.modelValue).then((l=>{B[e.field]=e.resultFormat?e.resultFormat(l):l.data}))}));const R=[];q.columns.forEach((e=>{var l;const o=R.map((e=>e.field));(null==(l=e.cascader)?void 0:l.length)&&!o.includes(e.field)&&R.push(e)}));const z=a((()=>d(q.modelValue)));return t(z,((e,l)=>{R.forEach((o=>{if(e[o.field]!==l[o.field]){q.columns.filter((e=>{var l;return null==(l=null==o?void 0:o.cascader)?void 0:l.includes(e.field)})).forEach((l=>{l.request&&Boolean(e[o.field])?l.request(q.modelValue).then((e=>{B[l.field]=l.resultFormat?l.resultFormat(e):e.data,B[l.field].map((e=>e.value)).includes(q.modelValue[l.field])||F("update:modelValue",Object.assign(q.modelValue,{[l.field]:""}))})):l.request&&!e[o.field]&&(B[l.field]=[],F("update:modelValue",Object.assign(q.modelValue,{[l.field]:""})))}))}}))})),(e,l)=>{const o=u("a-input"),a=u("a-input-number"),d=u("a-textarea"),t=u("a-select"),_=u("a-cascader"),g=u("a-tree-select"),$=u("a-radio-group"),R=u("a-checkbox-group"),z=u("a-date-picker"),D=u("a-time-picker"),G=u("a-rate"),H=u("a-switch"),I=u("a-slider"),P=u("a-form-item"),T=u("a-col"),A=u("icon-search"),J=u("a-button"),K=u("icon-up"),L=u("icon-down"),M=u("a-space"),N=u("a-row"),Q=u("a-form");return i(),n(Q,r({ref_key:"formRef",ref:E,"auto-label-width":!0},e.options.form,{model:e.modelValue}),{default:p((()=>[s(N,r({gutter:14},e.options.row,{class:"w-full"}),{default:p((()=>{var u,E,N;return[(i(!0),m(f,null,c(e.columns,((l,u)=>{var c,w,x;return i(),m(f,{key:l.field},[(x=l.hide,void 0!==x&&("boolean"==typeof x?x:"function"==typeof x?x(q.modelValue):void 0)?b("",!0):V((i(),n(T,r({key:0,span:l.span||12},l.col||l.span?l.col:e.options.col),{default:p((()=>[s(P,r(l.item,{label:l.label,field:l.field,rules:l.rules,disabled:O(l.disabled)}),{default:p((()=>[v(e.$slots,l.field,y(h({disabled:O(l.disabled)})),(()=>["input"===l.type?(i(),n(o,r({key:0,"allow-clear":!0,placeholder:`请输入${l.label}`,"max-length":20},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["placeholder","model-value","onUpdate:modelValue"])):b("",!0),"input-number"===l.type?(i(),n(a,r({key:1,placeholder:`请输入${l.label}`},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["placeholder","model-value","onUpdate:modelValue"])):b("",!0),"textarea"===l.type?(i(),n(d,r({key:2,"allow-clear":!0,placeholder:`请填写${l.label}`,"max-length":200,"show-word-limit":!0},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["placeholder","model-value","onUpdate:modelValue"])):b("",!0),"select"===l.type?(i(),n(t,r({key:3,"allow-clear":!0,placeholder:`请选择${l.label}`},l.props,{options:k(B)[l.field]||l.options,"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["placeholder","options","model-value","onUpdate:modelValue"])):b("",!0),"cascader"===l.type?(i(),n(_,r({key:4,"allow-clear":!0,placeholder:`请选择${l.label}`},l.props,{options:k(B)[l.field]||l.options,"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["placeholder","options","model-value","onUpdate:modelValue"])):b("",!0),"tree-select"===l.type?(i(),n(g,r({key:5,"allow-clear":!0,placeholder:`请选择${l.label}`},l.props,{data:k(B)[l.field]||l.data,"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["placeholder","data","model-value","onUpdate:modelValue"])):b("",!0),"radio-group"===l.type?(i(),n($,r({key:6},l.props,{options:k(B)[l.field]||l.options,"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["options","model-value","onUpdate:modelValue"])):b("",!0),"checkbox-group"===l.type?(i(),n(R,r({key:7},l.props,{options:k(B)[l.field]||l.options,"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["options","model-value","onUpdate:modelValue"])):b("",!0),"date-picker"===l.type?(i(),n(z,r({key:8,"allow-clear":!0,placeholder:"请选择日期"},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["model-value","onUpdate:modelValue"])):b("",!0),"time-picker"===l.type?(i(),n(D,r({key:9,"allow-clear":!0,placeholder:"请选择时间"},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["model-value","onUpdate:modelValue"])):b("",!0),"rate"===l.type?(i(),n(G,r({key:10,"allow-clear":!0},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["model-value","onUpdate:modelValue"])):b("",!0),"switch"===l.type?(i(),n(H,r({key:11},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["model-value","onUpdate:modelValue"])):b("",!0),"slider"===l.type?(i(),n(I,r({key:12},l.props,{"model-value":e.modelValue[l.field],"onUpdate:modelValue":e=>j(e,l.field)}),null,16,["model-value","onUpdate:modelValue"])):b("",!0)]))])),_:2},1040,["label","field","rules","disabled"])])),_:2},1040,["span"])),[[U,u<=((null==(c=e.options.fold)?void 0:c.index)||0)||u>=((null==(w=e.options.fold)?void 0:w.index)||0)&&!k(C)]]))],64)})),128)),(null==(u=e.options.btns)?void 0:u.hide)?b("",!0):(i(),n(T,r({key:0,span:(null==(E=e.options.btns)?void 0:E.span)||12},null==(N=e.options.btns)?void 0:N.col),{default:p((()=>[s(M,{wrap:""},{default:p((()=>[v(e.$slots,"suffix",{},(()=>{var o;return[s(J,{type:"primary",onClick:l[0]||(l[0]=e=>F("search"))},{icon:p((()=>[s(A)])),default:p((()=>{var l;return[w(x((null==(l=e.options.btns)?void 0:l.searchBtnText)||"搜索"),1)]})),_:1}),s(J,{onClick:l[1]||(l[1]=e=>F("reset"))},{default:p((()=>[w("重置")])),_:1}),(null==(o=e.options.fold)?void 0:o.enable)?(i(),n(J,{key:0,type:"text",size:"mini",onClick:l[2]||(l[2]=e=>C.value=!k(C))},{icon:p((()=>[k(C)?(i(),n(L,{key:1})):(i(),n(K,{key:0}))])),default:p((()=>[w(x(k(C)?"展开":"收起"),1)])),_:1})):b("",!0)]}))])),_:3})])),_:3},16,["span"]))]})),_:3},16)])),_:3},16,["model"])}}});export{_};
