import{G as he}from"./GiTitle.1ba9f8ce.js";import{eC as ye,r as g,s as Ce,v as q,d as M,q as te,o as T,m as N,w as t,T as ke,Q as ae,eD as we,j as B,a as F,n as Fe,Y as De,_ as L,h as J,c as K,G as W,i as o,b as e,I as X,k as y,eG as xe,eH as be,$ as Be,S as le,Z as Ee,K as $e,J as ue,L as Ae,z as Te,p as Ie,e as Ve,u as ze,eA as Se,M as Ne}from"./index.cffeb3a8.js";import"./index.463d26de.js";import{u as Me}from"./usePagination.4724fe46.js";import"./viewer.c9822194.js";import{o as Re,d as Oe,b as Pe}from"./index.f12ca541.js";import{G as Y,a as Ge}from"./GiOptionItem.2802f75d.js";import{g as He}from"./index.e78944ce.js";const je="/mock";function Ue(){return ye.get(`${je}/cate/tree`)}function We(r,p,i={alignPoint:!1}){const a=g(!1),f=g(0),c=g(0),u=d=>{a.value=d},m=()=>{const d={};return r.clientX>window.innerWidth-c.value?d.right=i.alignPoint?window.innerWidth-r.clientX-f.value/2+"px":window.innerWidth-r.clientX+"px":d.left=i.alignPoint?r.clientX+f.value/2+"px":r.clientX+"px",r.clientY>window.innerHeight-c.value?(d.bottom=window.innerHeight-r.clientY+"px",d["transform-origin"]="center bottom"):(d.top=r.clientY+2+"px",d["transform-origin"]="center top"),d["z-index"]=999,d};return Ce(()=>{a.value=!0,q(()=>{var d,k;p!==null&&p.value&&(c.value=(d=p.value)==null?void 0:d.offsetHeight,f.value=(k=p.value)==null?void 0:k.offsetWidth,m())})}),{visible:a,setVisible:u,getStyle:m}}function qe(r,p="\u65B0\u5EFA\u5206\u7C7B"){let i=0;for(let a=0;a<r.length+1;a++)if(!r.includes(`${p}${a+1}`)){i=a+1;break}return`${p}${i}`}const Le=M({name:"GiContextMenu"}),Xe=M({...Le,props:{event:null,options:null,ignoreRefs:null},emits:["close"],setup(r,{expose:p,emit:i}){const a=r,f=g(null),{visible:c,setVisible:u,getStyle:m}=We(a.event,f,a.options);Re(f,()=>{u(!1),i("close")},{capture:!1,ignore:a.ignoreRefs});const{width:d,height:k}=Oe();return te(()=>[d.value,k.value],()=>{u(!1),i("close")}),p({visible:c,onHidden:()=>{u(!1),i("close")}}),(C,h)=>(T(),N(ke,{name:"slide-dynamic-origin"},{default:t(()=>[ae(F("div",{class:"gi-context-menu",ref_key:"elRef",ref:f,style:De(B(m)())},[Fe(C.$slots,"default",{},void 0,!0)],4),[[we,B(c)]])]),_:3}))}});const Ye=L(Xe,[["__scopeId","data-v-099cfc3c"]]),Je={id:"movetree",ref:"moveTreeRef",class:"ztree move-tree"},Ke=M({__name:"MoveTree",props:{treeData:{type:Array,default:()=>[]}},emits:["node-click"],setup(r,{emit:p}){const i=r,a=g({}),f=J({callback:{onClick:(u,m,d)=>{c(u,m,d)}}});te(i.treeData,()=>{q(()=>{a.value=$.fn.zTree.init($("#movetree"),f,i.treeData),a.value.expandAll(!0)})},{deep:!0,immediate:!0});function c(u,m,d){p("node-click",d)}return(u,m)=>(T(),K("ul",Je,null,512))}}),Qe=y("\u65B0\u589E"),Ze=y("\u91CD\u547D\u540D"),et=y(" \u79FB\u52A8 "),tt=y("\u5220\u9664"),nt=M({__name:"Menu",props:{event:null,fileInfo:null,treeData:null,onClose:null,onClick:null},setup(r,{expose:p}){const i=r,a=g(null),f=g(null),c=g([f]),u=g(!1),m=W(()=>i.fileInfo.id!==""),d=W(()=>i.fileInfo.id!=="root"),k=W(()=>i.fileInfo.id!=="root"),I=W(()=>i.fileInfo.id!=="root"),C=()=>{u.value=!1,i.onClose()},h=D=>{if(D==="move")return u.value=!u.value,!1;q(()=>{i.onClick(D),a.value.onHidden()})},V=()=>{a.value.onHidden()};return p({menuRef:a,showMoveTreePopup:u,onClose:C,onClickItem:h}),(D,w)=>{const z=o("a-popover");return T(),N(Ye,{ref_key:"menuRef",ref:a,event:r.event,ignoreRefs:c.value,onClose:C},{default:t(()=>[e(Ge,{width:"110",ref:"optionRef",style:{position:"relative"}},{default:t(()=>[B(m)?(T(),N(Y,{key:0,icon:"IconPlusCircle",onClick:w[0]||(w[0]=l=>h("add"))},{default:t(()=>[Qe]),_:1})):X("",!0),B(d)?(T(),N(Y,{key:1,icon:"IconEdit",onClick:w[1]||(w[1]=l=>h("rename"))},{default:t(()=>[Ze]),_:1})):X("",!0),e(z,{position:"right",trigger:"click","content-style":{padding:0,overflow:"hidden"},"unmount-on-close":!1,"popup-visible":u.value},{content:t(()=>[F("section",{class:"move-tree-box",ref_key:"moveTreeBoxRef",ref:f},[e(Ke,{"tree-data":r.treeData,onNodeClick:V},null,8,["tree-data"])],512)]),default:t(()=>[B(k)?(T(),N(Y,{key:0,more:"",icon:"IconExport",active:u.value,onClick:w[2]||(w[2]=l=>h("move"))},{default:t(()=>[et]),_:1},8,["active"])):X("",!0)]),_:1},8,["popup-visible"]),B(I)?(T(),N(Y,{key:2,icon:"IconDelete",onClick:w[3]||(w[3]=l=>h("delete"))},{default:t(()=>[tt]),_:1})):X("",!0)]),_:1},512)]),_:1},8,["event","ignoreRefs"])}}});const ot=L(nt,[["__scopeId","data-v-e17d1a21"]]);let P=null,H=null;function at(r,p,i){return new Promise(a=>{f(),H=document.createElement("div"),document.body.appendChild(H),P=xe(ot,{event:r,fileInfo:p,treeData:i,onClick:c=>{a({mode:c,fileInfo:p}),setTimeout(()=>{f()},360)},onClose:()=>{setTimeout(()=>{f()},360)}}),P.use(be),P.use(Be),P.mount(H);function f(){P!==null&&(P.unmount(),P=null),H!==null&&(document.body.removeChild(H),H=null)}})}const ee="/gi-demo/assets/com-file-open.a82dbda1.svg",U="/gi-demo/assets/com-file-close.e0ebbcc4.svg",lt="/gi-demo/assets/com-file.9070581a.svg",ut={class:"cate-tree"},st={class:"search-wrap"},it={class:"wrap"},ct=M({__name:"index",props:{type:{type:Number,default:1},placeholder:{type:String,default:"\u8BF7\u8F93\u5165\u5173\u952E\u8BCD"}},emits:["node-click"],setup(r,{emit:p}){const i=g(!1),a=g(""),f=g(null),c=g([]),u=g(null),m=g(null),d=(l,_,s)=>{console.log("\u70B9\u51FB\u8282\u70B9",s),m.value=s,p("node-click")},k=J({callback:{onRightClick:(l,_,s)=>{console.log("\u9F20\u6807\u53F3\u952E",s),s&&(m.value=s,at(l,s,c.value).then(n=>{console.log("res",n),n.mode==="add"&&h(),n.mode==="rename"&&V(),n.mode==="delete"&&D()}))},onClick:(l,_,s)=>{d(l,_,s)}}}),I=l=>{if(!l.length)return;function _(s){s.forEach(n=>{n.children&&n.children.length?(n.iconOpen=ee,n.iconClose=U,_(n.children)):(n.children=null,n.iconOpen=ee,n.iconClose=U,n.icon=U,n.type==null&&(n.icon=lt))})}_(l)};(async()=>{try{i.value=!0;const l=await Ue();if(l.success){const _=l.data;I(_),c.value=_,q(()=>{var s;u.value=$.fn.zTree.init($("#treeDemo"),k,c.value),(s=u.value)==null||s.expandAll(!0)})}}catch(l){return l}finally{i.value=!1}})();const h=()=>{var x,G,R;const l=((x=m.value)==null?void 0:x.children)||[];let _="\u65B0\u5EFA\u5206\u7C7B1";if(l&&l.length){const S=l.map(E=>E.name);_=qe(S,"\u65B0\u5EFA\u5206\u7C7B")}const s=new Date().getTime().toString(),n={id:s,name:_,children:null,iconOpen:ee,iconClose:U,icon:U,isParent:!1};(G=u.value)==null||G.addNodes(m.value||{},n,!0);const v=(R=u.value)==null?void 0:R.getNodesByParam("id",s);setTimeout(()=>{var S;(S=u.value)==null||S.editName(v[0])},100)},V=()=>{q(()=>{var _,s,n;const l=(s=u.value)==null?void 0:s.getNodesByParam("id",(_=m.value)==null?void 0:_.id);(n=u.value)==null||n.editName(l[0])})},D=()=>{le.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",hideCancel:!1})},w=(l,_)=>{let s=!1;if(l.name.indexOf(_)>-1&&(s=!0),l.children){const n=l.children;for(let v=0;v<n.length;v++){const x=n[v];w(x,_)?s=!0:n.splice(v--,1)}}return s},z=()=>{var _,s;let l=a.value;if(!l)u.value=$.fn.zTree.init($("#treeDemo"),k,c.value),(_=u.value)==null||_.expandAll(!0);else{const n=JSON.parse(JSON.stringify(c.value));for(let v=0;v<n.length;v++)w(n[v],l)||n.splice(v--,1);u.value=$.fn.zTree.init($("#treeDemo"),k,n),(s=u.value)==null||s.expandAll(!0)}};return(l,_)=>{const s=o("icon-search"),n=o("a-input");return T(),K("div",ut,[F("div",st,[e(n,{"allow-clear":"",maxlength:20,placeholder:r.placeholder,modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=v=>a.value=v),onInput:z,onClear:z},{prefix:t(()=>[e(s)]),_:1},8,["placeholder","modelValue"])]),F("div",it,[F("ul",{id:"treeDemo",ref_key:"treeRef",ref:f,class:"ztree cate-ztree"},null,512)])])}}});const rt=L(ct,[["__scopeId","data-v-f49d6ff3"]]),ne=r=>(Ie("data-v-f11df0a9"),r=r(),Ve(),r),dt=ne(()=>F("div",null,"\u4EC5\u652F\u6301\u4E2D\u6587\u59D3\u540D",-1)),_t=y("\u5173\u95ED"),pt=y("\u5F00\u542F"),ft=ne(()=>F("span",null,"\u6743\u9650\u914D\u7F6E",-1)),mt=ne(()=>F("span",null,"\u81EA\u5B9A\u4E49\u7BA1\u7406\u5458\u3001\u7F16\u8F91\u8005\u7684\u6743\u9650\uFF0C \u70B9\u51FB",-1)),vt=y("\u4E86\u89E3\u66F4\u591A\u6743\u9650"),gt=y("\u7BA1\u7406\u5458"),ht=y("\u7F16\u8F91\u8005"),yt=M({__name:"EditDialog",props:{modelValue:{type:Boolean,default:!1},formData:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(r,{emit:p}){const i=r,a=Pe(i,"modelValue",p),f=[{name:"\u65B0\u589E"},{name:"\u7F16\u8F91"},{name:"\u91CD\u547D\u540D"},{name:"\u5206\u4EAB"},{name:"\u5220\u9664"}],c=J({name:"",address:"",status:!1}),u=J({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D"},{minLength:1,maxLength:4,message:"\u540D\u5B57\u6700\u957F\u4E0D\u8D85\u8FC74\u4E2A\u5B57\u7B26"}],status:[{required:!0}]}),m=W(()=>!!i.formData.id);te(a,()=>{const{name:I,address:C,status:h}=i.formData;c.name=I,c.address=C,c.status=h||!1});const d=()=>{a.value=!1},k=()=>{a.value=!1};return(I,C)=>{const h=o("a-input"),V=o("a-form-item"),D=o("a-radio"),w=o("a-radio-group"),z=o("a-form"),l=o("icon-question-circle-fill"),_=o("a-link"),s=o("a-tooltip"),n=o("a-space"),v=o("icon-right"),x=o("a-checkbox"),G=o("a-checkbox-group"),R=o("a-row"),S=o("a-collapse-item"),E=o("a-collapse"),Q=o("a-modal");return T(),N(Q,{visible:B(a),"onUpdate:visible":C[3]||(C[3]=b=>Te(a)?a.value=b:null),title:B(m)?"\u7F16\u8F91":"\u65B0\u589E",onOk:k,onCancel:d},{default:t(()=>[e(z,{ref:"formRef",model:c,style:{width:"450px"}},{default:t(()=>[e(V,{field:"name",label:"\u59D3\u540D",rules:u.name},{extra:t(()=>[dt]),default:t(()=>[e(h,{modelValue:c.name,"onUpdate:modelValue":C[0]||(C[0]=b=>c.name=b),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",style:{width:"280px"}},null,8,["modelValue"])]),_:1},8,["rules"]),e(V,{field:"address",label:"\u5730\u5740"},{default:t(()=>[e(h,{modelValue:c.address,"onUpdate:modelValue":C[1]||(C[1]=b=>c.address=b),placeholder:"\u8BF7\u8F93\u5165\u5730\u5740",style:{width:"280px"}},null,8,["modelValue"])]),_:1}),e(V,{field:"status",label:"\u72B6\u6001",rules:u.status},{default:t(()=>[e(w,{modelValue:c.status,"onUpdate:modelValue":C[2]||(C[2]=b=>c.status=b)},{default:t(()=>[e(D,{value:!1},{default:t(()=>[_t]),_:1}),e(D,{value:!0},{default:t(()=>[pt]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"]),e(E,{bordered:!1,"default-active-key":["1"]},{default:t(()=>[e(S,{"show-expand-icon":!0,key:"1"},{header:t(()=>[e(n,null,{default:t(()=>[ft,e(s,{position:"right","content-style":{width:"200px"}},{content:t(()=>[mt,e(_,{type:"primary"},{default:t(()=>[vt]),_:1})]),default:t(()=>[e(l,{style:{color:"rgb(var(--warning-6))"}})]),_:1})]),_:1})]),"expand-icon":t(({active:b})=>[e(v,{class:Ee({gi_rotate_90deg:b})},null,8,["class"])]),default:t(()=>[(T(),K(Ae,null,$e(f,(b,j)=>e(R,{justify:"space-between",key:j},{default:t(()=>[F("span",null,ue(b.name),1),e(G,null,{default:t(()=>[e(x,{value:"1"},{default:t(()=>[gt]),_:1}),e(x,{value:"2"},{default:t(()=>[ht]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["visible","title"])}}});const Ct=L(yt,[["__scopeId","data-v-f11df0a9"]]),kt={class:"manage"},wt={class:"tab"},Ft={class:"gi_lr_page wrap"},Dt={class:"left"},xt={class:"right"},bt={class:"content"},Bt=y("\u5220\u9664"),Et=y("\u5317\u4EAC"),$t=y("\u4E0A\u6D77"),At=y("\u5E7F\u5DDE"),Tt={class:"table-box"},It=y("\u5F00\u542F"),Vt=y("\u5173\u95ED"),zt=y("\u4FEE\u6539"),St=y("\u8BE6\u60C5"),Nt=y("\u5220\u9664"),Mt=M({name:"IndicatorManage"}),Rt=M({...Mt,setup(r){const p=ze(),{current:i,pageSize:a,total:f,changeCurrent:c,changePageSize:u,setTotal:m}=Me(()=>{h()}),d=g("2"),k=g([]),I=g(!1),C=n=>n<30?"danger":n<60?"warning":"success",h=async()=>{try{I.value=!0;const n=await He({current:i.value,pageSize:a.value});k.value=n.data.list,m(n.data.total)}catch(n){return n}finally{I.value=!1}};h();const V=()=>{le.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",hideCancel:!1,onOk:()=>{k.value=[]}})},D=g(!1),w=g({}),z=n=>{w.value=n,D.value=!0},l=()=>{D.value=!0},_=()=>{p.push({path:"/indicator/detail"})},s=n=>{Ne.success("\u5220\u9664\u6210\u529F")};return(n,v)=>{const x=o("a-tab-pane"),G=o("a-tabs"),R=he,S=o("icon-plus"),E=o("a-button"),Q=o("icon-delete"),b=o("icon-download"),j=o("a-space"),Z=o("a-option"),se=o("a-select"),ie=o("a-input"),ce=o("icon-search"),re=o("a-input-group"),de=o("icon-refresh"),oe=o("a-row"),O=o("a-table-column"),_e=o("a-progress"),pe=o("a-switch"),fe=o("a-popconfirm"),me=o("a-table"),ve=Se("loading");return T(),K("div",kt,[F("section",wt,[e(G,{"hide-content":"",size:"medium","active-key":d.value,"onUpdate:active-key":v[0]||(v[0]=A=>d.value=A)},{default:t(()=>[e(x,{key:"1",title:"\u539F\u5B50\u6307\u6807\u7BA1\u7406"}),e(x,{key:"2",title:"\u65F6\u95F4\u5468\u671F\u7BA1\u7406"}),e(x,{key:"3",title:"\u7EF4\u5EA6\u7BA1\u7406"}),e(x,{key:"4",title:"\u8BA1\u91CF\u5355\u4F4D\u7BA1\u7406"}),e(x,{key:"5",title:"\u6D3E\u751F\u6307\u6807\u7BA1\u7406"})]),_:1},8,["active-key"])]),F("section",Ft,[F("div",Dt,[e(R,{title:"\u6307\u6807\u5206\u7C7B"}),e(rt,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD",onNodeClick:h})]),F("div",xt,[e(R,{title:"\u6307\u6807\u5217\u8868"}),F("div",bt,[e(oe,{justify:"space-between",style:{"margin-bottom":"12px"}},{default:t(()=>[e(j,null,{default:t(()=>[e(E,{type:"primary",onClick:l},{icon:t(()=>[e(S)]),_:1}),e(E,{type:"primary",status:"danger",onClick:V},{icon:t(()=>[e(Q)]),default:t(()=>[Bt]),_:1}),e(E,{type:"primary",status:"success"},{icon:t(()=>[e(b)]),_:1})]),_:1}),e(j,null,{default:t(()=>[e(se,{class:"gi_select_input",placeholder:"\u8BF7\u9009\u62E9","trigger-props":{updateAtScroll:!0}},{default:t(()=>[e(Z,null,{default:t(()=>[Et]),_:1}),e(Z,null,{default:t(()=>[$t]),_:1}),e(Z,null,{default:t(()=>[At]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(ie,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD","allow-clear":""}),e(E,{type:"primary",onClick:h},{default:t(()=>[e(ce)]),_:1})]),_:1}),e(E,{type:"primary",onClick:h},{icon:t(()=>[e(de)]),_:1})]),_:1})]),_:1}),F("section",Tt,[ae((T(),N(me,{"row-key":"id",bordered:{cell:!0},data:k.value,scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:{showPageSize:!0,total:B(f),current:B(i),pageSize:B(a)},onPageChange:B(c),onPageSizeChange:B(u)},{columns:t(()=>[e(O,{title:"\u5E8F\u53F7",width:68},{cell:t(A=>[y(ue(A.rowIndex+1),1)]),_:1}),e(O,{title:"\u59D3\u540D","data-index":"name"}),e(O,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"startTime",width:180}),e(O,{title:"\u5730\u5740","data-index":"address",ellipsis:"",tooltip:""}),e(O,{title:"\u6BD4\u4F8B",width:200},{cell:t(({record:A})=>[e(_e,{status:C(A.proportion),percent:A.proportion/100},null,8,["status","percent"])]),_:1}),e(O,{title:"\u72B6\u6001",width:100},{cell:t(({record:A})=>[e(pe,{"model-value":A.status,size:"medium"},{checked:t(()=>[It]),unchecked:t(()=>[Vt]),_:2},1032,["model-value"])]),_:1}),e(O,{title:"\u64CD\u4F5C",width:200,align:"center"},{cell:t(({record:A})=>[e(oe,{justify:"center"},{default:t(()=>[e(j,null,{default:t(()=>[e(E,{type:"primary",size:"mini",onClick:ge=>z(A)},{default:t(()=>[zt]),_:2},1032,["onClick"]),e(E,{size:"mini",onClick:_},{default:t(()=>[St]),_:1}),e(fe,{type:"warning",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u9879\u5417?",onOk:ge=>s()},{default:t(()=>[e(E,{type:"primary",status:"danger",size:"mini"},{default:t(()=>[Nt]),_:1})]),_:2},1032,["onOk"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","pagination","onPageChange","onPageSizeChange"])),[[ve,I.value]])])])]),e(Ct,{modelValue:D.value,"onUpdate:modelValue":v[1]||(v[1]=A=>D.value=A),"form-data":w.value},null,8,["modelValue","form-data"])])])}}});const Lt=L(Rt,[["__scopeId","data-v-b0cda5b5"]]);export{Lt as default};
