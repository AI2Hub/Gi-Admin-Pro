import{_ as e}from"./index-CWjC7o0Y.js";import{d as a,u as t,k as l,J as r,e as s,o as d,f as n,h as o,w as i,m as u,g as c,F as p,j as m,c as f,E as y,r as x,b as _,G as b,t as h,i as v,U as w,_ as I}from"./index-B_H-0aOB.js";import{a as g}from"./regexp-LyZ7ySAN.js";import{u as k}from"./useDict-W4bbc9i9.js";const C={class:"gi-edit-table"},$=a({name:"GiEditTable",inheritAttrs:!1,__name:"GiEditTable",props:{columns:{},data:{},cellDisabled:{default:!1}},setup(e,{expose:a}){const _=e,b=t(),h=l((()=>({tableData:_.data}))),v=r("formRef"),w=e=>e.required?"gi_column_require":"",I=e=>{const a={};return"input"===e.type&&(a.allowClear=!0,a.placeholder=`请输入${e.title}`,a.maxLength=50),"input-number"===e.type&&(a.placeholder=`请输入${e.title}`),"textarea"===e.type&&(a.allowClear=!0,a.placeholder=`填写${e.title}`,a.maxLength=200),"select"===e.type&&(a.allowClear=!0,a.placeholder=`请选择${e.title}`),"cascader"===e.type&&(a.allowClear=!0,a.placeholder=`请选择${e.title}`),"tree-select"===e.type&&(a.allowClear=!0,a.placeholder=`请选择${e.title}`),"date-picker"===e.type&&(a.placeholder="请选择日期"),"time-picker"===e.type&&(a.allowClear=!0,a.placeholder="请选择时间"),{...a,...e.props}},g=e=>["input","input-number"].includes(e.type??"")?`请输入${e.title}`:["textarea"].includes(e.type??"")?`请填写${e.title}`:["select","cascader","tree-select"].includes(e.type??"")?`请选择${e.title}`:["date-picker"].includes(e.type??"")?"请选择日期":["time-picker"].includes(e.type??"")?"请选择时间":"";return a({formRef:v}),(e,a)=>{const t=s("a-form-item"),l=s("a-table-column"),r=s("a-table"),k=s("a-form");return d(),n("div",C,[o(k,{ref_key:"formRef",ref:v,model:c(h)},{default:i((()=>[o(r,u({data:c(h).tableData,bordered:{cell:!0},pagination:!1},c(b)),{columns:i((()=>[(d(!0),n(p,null,m(_.columns,(a=>(d(),f(l,u({key:a.dataIndex,title:a.title,"data-index":a.dataIndex,"header-cell-class":w(a),ref_for:!0},a.columnProps),{cell:i((({record:l,rowIndex:r,column:s})=>[o(t,u({field:`tableData[${r}].${a.dataIndex}`,"label-col-style":{display:"none"},"wrapper-col-props":{span:24},ref_for:!0},a.formItemProps,{rules:[{required:a.required||!1,message:g(a)},...a.rules||[]]}),{default:i((()=>{return[a.slotName?y(e.$slots,a.dataIndex,u({key:0,ref_for:!0},{record:l,rowIndex:r,column:s})):(d(),f(x(`a-${a.type}`),u({key:1,ref_for:!0},I(a),{modelValue:l[a.dataIndex],"onUpdate:modelValue":e=>l[a.dataIndex]=e,disabled:(t={row:l,rowIndex:r,col:a},"boolean"==typeof(null==_?void 0:_.cellDisabled)?_.cellDisabled:"function"==typeof(null==_?void 0:_.cellDisabled)&&_.cellDisabled(t))}),null,16,["modelValue","onUpdate:modelValue","disabled"]))];var t})),_:2},1040,["field","rules"])])),_:2},1040,["title","data-index","header-cell-class"])))),128))])),_:3},16,["data"])])),_:3},8,["model"])])}}}),j={class:"gi_page"},D=I(a({name:"FormTable",__name:"index",setup(a){const{data:t}=k({code:"status"}),u=_(!1),p=_([{name:"张三",phone:"",address:"广州市",rate:3,status:0,num:0}]),m=l((()=>JSON.stringify(p.value,null,"\t"))),f=r("GiEditTableRef"),y=l((()=>[{type:"input",title:"姓名",dataIndex:"name",required:!0},{type:"input",title:"手机号",dataIndex:"phone",required:!0,rules:[{match:g,message:"手机号格式不正确"}]},{type:"select",title:"状态",dataIndex:"status",props:{options:t.value}},{type:"rate",title:"评分",dataIndex:"rate",columnProps:{width:200}},{type:"input-number",title:"小数",dataIndex:"num",columnProps:{width:120}},{type:"textarea",title:"地址",dataIndex:"address",props:{autoSize:!0,maxLength:200,showWordLimit:!0},columnProps:{width:250}},{type:"",title:"操作",dataIndex:"action",slotName:"action",columnProps:{width:100,align:"center",fixed:"right"},formItemProps:{contentClass:"arco-table-cell-align-center"}}])),x=()=>{p.value.push({name:"",phone:"",address:"",rate:0,status:0,num:0})},I=()=>{var e,a,t,l;null==(a=null==(e=f.value)?void 0:e.formRef)||a.resetFields(),null==(l=null==(t=f.value)?void 0:t.formRef)||l.clearValidate()},C=async()=>{var e,a;const t=await(null==(a=null==(e=f.value)?void 0:e.formRef)?void 0:a.validate());if(t){const e=Object.values(t);w.warning(e[0].message)}else w.success("验证通过~")},D=({rowIndex:e,col:a})=>!!u.value||"name"===a.dataIndex&&0===e;return(a,t)=>{const l=s("a-button"),r=s("icon-plus"),_=s("a-space"),w=s("a-row"),g=$,k=e,R=s("a-card");return d(),n("div",j,[o(R,{title:"编辑表格"},{default:i((()=>[o(w,{justify:"end"},{default:i((()=>[o(_,{wrap:""},{default:i((()=>[o(l,{type:"primary",status:c(u)?"success":"warning",onClick:t[0]||(t[0]=e=>u.value=!c(u))},{default:i((()=>[b(h(c(u)?"编辑":"只读"),1)])),_:1},8,["status"]),o(l,{type:"primary",onClick:x},{icon:i((()=>[o(r)])),default:i((()=>[t[1]||(t[1]=v("span",null,"新增",-1))])),_:1})])),_:1})])),_:1}),o(g,{ref_key:"GiEditTableRef",ref:f,scroll:{minWidth:1200},columns:c(y),data:c(p),"cell-disabled":D},{action:i((({rowIndex:e})=>[o(_,null,{default:i((()=>[o(l,{type:"primary",status:"danger",size:"mini",disabled:0===e,onClick:a=>{return t=e,void p.value.splice(t,1);var t}},{default:i((()=>t[2]||(t[2]=[b(" 删除 ")]))),_:2},1032,["disabled","onClick"])])),_:2},1024)])),_:1},8,["columns","data"]),o(w,{justify:"end",class:"gi_mt"},{default:i((()=>[o(_,{wrap:""},{default:i((()=>[o(l,{onClick:I},{default:i((()=>t[3]||(t[3]=[b("重置")]))),_:1}),o(l,{type:"primary",onClick:C},{default:i((()=>t[4]||(t[4]=[b("验证并提交")]))),_:1})])),_:1})])),_:1}),o(k,{"code-json":c(m)},null,8,["code-json"])])),_:1})])}}}),[["__scopeId","data-v-e9e9f6ba"]]);export{D as default};
